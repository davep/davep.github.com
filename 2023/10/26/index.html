<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="blogmore v0.11.0">
    <title>Posts from October 26, 2023 - davep</title>
    
    <link rel="icon" href="/icons/favicon.ico">
    
    
    <!-- Shortcut icon for backward compatibility -->
    <link rel="shortcut icon" href="/favicon.ico">
    <!-- Favicon alternatives -->
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-touch-icon-120.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-touch-icon-152.png">
    <link rel="apple-touch-icon" sizes="167x167" href="/icons/apple-touch-icon-167.png">
    <!-- Android/Chrome -->
    <link rel="manifest" href="/icons/site.webmanifest">
    <!-- Windows/Edge -->
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-config" content="/icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    
    
    <link rel="stylesheet" href="/static/fontawesome.css">
    
    <link rel="stylesheet" href="/static/style.css">
    
    
    <link rel="alternate" type="application/rss+xml" title="davep - RSS Feed" href="https://blog.davep.org/feed.xml">
    <link rel="alternate" type="application/atom+xml" title="davep - Atom Feed" href="https://blog.davep.org/feeds/all.atom.xml">
    
    
    
    <meta name="author" content="Dave Pearson">
    
    
    
<meta property="og:title" content="Posts from October 26, 2023 - davep">

<meta name="description" content="Dave Pearson&#39;s personal blog">
<meta property="og:description" content="Dave Pearson&#39;s personal blog">
<meta name="twitter:description" content="Dave Pearson&#39;s personal blog">


<meta name="keywords" content="Emacs, Python, Programming, Terminal, Textual">


    <script src="/static/theme.js"></script>
    
</head>
<body>
    <div class="site-container">
        <aside class="sidebar">
            <div class="sidebar-content">
                <div class="sidebar-header">
                    
                    <div class="sidebar-logo">
                        <a href="/">
                            <img src="/logo.jpeg" alt="davep">
                        </a>
                    </div>
                    

                    <div class="sidebar-title">
                        <h1><a href="/">davep</a></h1>
                        
                        <p class="sidebar-subtitle">Code and stuff</p>
                        
                    </div>
                </div>

                
                <div class="sidebar-pages">
                    <ul class="sidebar-links">
                        
                        <li><a href="/about.html">About</a></li>
                        
                        <li><a href="/dotfiles.html">Dot Files</a></li>
                        
                    </ul>
                </div>
                

                
                <section class="sidebar-section">
                    <h2>Links</h2>
                    <ul class="sidebar-links">
                        
                        <li><a href="https://davep.at/" target="_blank" rel="noopener noreferrer">davep@</a></li>
                        
                        <li><a href="https://raindrop.io/davep/public-46742255/sort=-created&amp;perpage=30&amp;page=0" target="_blank" rel="noopener noreferrer">Bookmarks</a></li>
                        
                        <li><a href="https://seenbydavep.blogspot.com/" target="_blank" rel="noopener noreferrer">Photoblog</a></li>
                        
                        <li><a href="https://elisp.dev/" target="_blank" rel="noopener noreferrer">Emacs Packages</a></li>
                        
                        <li><a href="https://pypi.org/user/davepearson/" target="_blank" rel="noopener noreferrer">Python Packages</a></li>
                        
                    </ul>
                </section>
                

                
                <section class="sidebar-section">
                    <h2>Social</h2>
                    <div class="sidebar-socials">
                        
                        <a href="https://www.flickr.com/photos/davepearson/" title="flickr" aria-label="flickr" target="_blank" rel="noopener noreferrer">
                            <i class="fa-brands fa-flickr"></i>
                        </a>
                        
                        <a href="https://github.com/davep" title="github" aria-label="github" target="_blank" rel="noopener noreferrer">
                            <i class="fa-brands fa-github"></i>
                        </a>
                        
                        <a href="https://www.last.fm/user/davepdotorg" title="lastfm" aria-label="lastfm" target="_blank" rel="noopener noreferrer">
                            <i class="fa-brands fa-lastfm"></i>
                        </a>
                        
                        <a href="https://fosstodon.org/@davep" title="mastodon" aria-label="mastodon" target="_blank" rel="noopener noreferrer">
                            <i class="fa-brands fa-mastodon"></i>
                        </a>
                        
                        <a href="https://www.npmjs.com/~davep.org" title="npm" aria-label="npm" target="_blank" rel="noopener noreferrer">
                            <i class="fa-brands fa-npm"></i>
                        </a>
                        
                        <a href="https://steamcommunity.com/id/davepdotorg" title="steam" aria-label="steam" target="_blank" rel="noopener noreferrer">
                            <i class="fa-brands fa-steam"></i>
                        </a>
                        
                        <a href="https://www.youtube.com/user/daveporg" title="youtube" aria-label="youtube" target="_blank" rel="noopener noreferrer">
                            <i class="fa-brands fa-youtube"></i>
                        </a>
                        
                    </div>
                </section>
                
            </div>
        </aside>

        <div class="main-wrapper">
            <header>
                <nav>
                    <ul>
                        <li><a href="/categories.html">Categories</a></li>
                        <li><a href="/tags.html">Tags</a></li>
                        <li><a href="/archive.html">Archive</a></li>
                        
                        <li><a href="/search.html">Search</a></li>
                        
                        
                        <li><a href="/feed.xml" title="Subscribe via RSS feed">RSS</a></li>
                        <li><a href="/feeds/all.atom.xml" title="Subscribe via Atom feed">Atom</a></li>
                        
                        <li>
                            <button class="theme-toggle" type="button" aria-label="Toggle theme">
                                <span class="icon light-icon">‚òÄÔ∏è</span>
                                <span class="icon dark-icon">üåô</span>
                                <span class="theme-label">Theme</span>
                            </button>
                        </li>
                    </ul>
                </nav>
            </header>

            <main>
                
<div class="archive">
    <h1>Posts from October 26, 2023</h1>
    
    
    
    
    
    <article class="post-summary">
        <h2><a href="/2023/10/26/visual-selection.html">Visual Selection</a></h2>
        
        <time datetime="2023-10-26T18:50:00+01:00"><a href="/2023/">2023</a>-<a href="/2023/10/">10</a>-<a href="/2023/10/26/">26</a> 18:50:00 UTC+01:00</time>
        
        <div class="reading-time">4 min read</div>
        
        <div class="category">
            <a href="/category/coding.html" class="category-link">Coding</a>
        </div>
        
        <div class="post-content">
            <p>Over the last few weeks I've had a couple of sessions of working on a
library to wrap <a href="https://pypi.org/project/plotext/" rel="noopener noreferrer" target="_blank">Plotext</a> -- a popular
terminal-based plotting library for Python -- so that it can easily be used
in Textual apps;
<a href="https://textual.textualize.io/blog/2023/10/04/announcing-textual-plotext/" rel="noopener noreferrer" target="_blank"><code>textual-plotext</code></a>
is the result.</p>
<p>I feel it's come together pretty well</p>
<p>But... I've been itching to find a reason to use it in a project of my own.</p>
<p>Meanwhile...</p>
<p>Back in the mid-2000s, when <a href="https://en.wikipedia.org/wiki/PhpBB" rel="noopener noreferrer" target="_blank">phpBB</a>
systems were still the fashion, I used to hang out on a site that was
chiefly aimed at the atheist and secular humanist crowd. We'd get a good
number of drive-by
<a href="https://en.wikipedia.org/wiki/Young_Earth_creationism" rel="noopener noreferrer" target="_blank">YEC</a> types who'd
want to argue (sorry... debate) and often talk nonsense about biology and
the like.</p>
<p>Now, I'm no biologist, I'm no scientist, I'm just a hacker who likes to
write code for fun and profit; so any time there was a chance to write some
code to help illustrate an idea I'd jump at the chance. I forget the detail
now -- this was back in 2008; 15 years ago as of the time of writing -- but
one time I remember a conversation was taking place where someone was just
flat out claiming that "random mutation" can only cause "loss of
information" and could never lead to a "desired result", or some such thing.</p>
<p>If you've ever had, read or watched those debates, you'll know the sort of
thing I mean.</p>
<p>So that got me thinking back then, could I write something that could give a
simple illustration of how this doesn't quite make sense?</p>
<p>So I had a little hacking session and came up with some Ruby code<sup id="fnref:95-1"><a class="footnote-ref" href="#fn:95-1">1</a></sup> that
did what I felt was the job. You'd give it a phrase you wanted it to
generate (a stand-in for the current "fitness landscape", in effect), it
would then generate a totally random string of that length, and then would
set about mutating it, finding mutations that were "fitter" than others (a
stand in for selection), breed the best two so far (randomly copy one chunk
from another to create a child), then repeat over and over.</p>
<p>When I first wrote it I wasn't sure what to expect; would it ever finish
given a reasonably large target string?</p>
<p>It did.</p>
<p>It was fun to code.</p>
<p>It got posted to the BB and of course wasn't in any way persuasive to them
(honestly I never expected it would be). I seem to recall it being
hand-waved away with calls of there obviously being an intelligent designer
involved<sup id="fnref:95-2"><a class="footnote-ref" href="#fn:95-2">2</a></sup>.</p>
<p>Anyway, the "meanwhile..." in this: a few times this year I've thought it
could be fun to rework this in Python (it's really not that complex after
all; just a string-chopping loop really) and use Textual to put a fun UI on
it.</p>
<p>So, that's what I did, complete with <code>textual-plotext</code> plot:</p>
<p><img alt="Visual Selection in action" src="/attachments/2023/10/26/visual-selection.png" /></p>
<p>While, 15 years on, this isn't going to convince anyone of the underlying
point, I think it does serve a good educational purpose. It shows that you
can create a fun UI for the terminal, with Textual, with not a lot of code.
It also shows off how you can easily create dynamic plots. Plus -- and I
think this might be the really important one -- it shows you can write
"traditional" tight-loop code in a Textual application and <em>still</em> have a
responsive UI; all thanks to the <a href="https://textual.textualize.io/guide/workers/" rel="noopener noreferrer" target="_blank">worker
API</a>.</p>
<p>The heart of the code for this application is this:</p>
<div class="highlight"><pre><span></span><code><span class="n">environment</span> <span class="o">=</span> <span class="n">Environment</span><span class="p">(</span><span class="s2">&quot;This is the target string we want to create!&quot;</span><span class="p">)</span>
<span class="k">while</span> <span class="ow">not</span> <span class="n">environment</span><span class="o">.</span><span class="n">best_fit_found</span><span class="p">:</span>
    <span class="n">environment</span><span class="o">.</span><span class="n">shit_happens</span><span class="p">()</span>
</code></pre></div>

<p>Sure, there's some detail in the <code>Environment</code> class, but you get the idea:
while we've not hit the target, let <a href="https://www.youtube.com/watch?v=kiVVzxoPTtg" rel="noopener noreferrer" target="_blank">life find a
way</a>. A loop like that would
totally bog down an application with a UI without some other work taking
place. With Textual and workers the resulting method in the application,
complete with code to send updates to the UI, really doesn't look much
different:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@work</span><span class="p">(</span><span class="n">thread</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exclusive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">run_world</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">worker</span> <span class="o">=</span> <span class="n">get_current_worker</span><span class="p">()</span>
    <span class="n">environment</span> <span class="o">=</span> <span class="n">Environment</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
    <span class="n">iterations</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">post_message</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">WorldUpdate</span><span class="p">(</span><span class="n">environment</span><span class="p">,</span> <span class="n">iterations</span><span class="p">,</span> <span class="o">*</span><span class="n">environment</span><span class="o">.</span><span class="n">best</span><span class="p">))</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="n">worker</span><span class="o">.</span><span class="n">is_cancelled</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">environment</span><span class="o">.</span><span class="n">best_fit_found</span><span class="p">:</span>
        <span class="n">environment</span><span class="o">.</span><span class="n">shit_happens</span><span class="p">()</span>
        <span class="n">iterations</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">iterations</span> <span class="o">%</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">environment</span><span class="o">.</span><span class="n">best_fit_found</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">post_message</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">WorldUpdate</span><span class="p">(</span><span class="n">environment</span><span class="p">,</span> <span class="n">iterations</span><span class="p">,</span> <span class="o">*</span><span class="n">environment</span><span class="o">.</span><span class="n">best</span><span class="p">)</span>
            <span class="p">)</span>
    <span class="k">if</span> <span class="n">environment</span><span class="o">.</span><span class="n">best_fit_found</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">post_message</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Finished</span><span class="p">(</span><span class="n">iterations</span><span class="p">))</span>
</code></pre></div>

<p>I honestly think the worker API is one of the coolest things added to
Textual and I so often see people have real <em>"woah!"</em> moments when they get
to grips with it.</p>
<p>Anyway... I've covered science, religion, and how Ruby is better than
Python, so I'm sure I've annoyed almost everyone. Job done I guess. ;-)</p>
<p>If you want to check out the app itself there's <a href="https://github.com/davep/visual-selection" rel="noopener noreferrer" target="_blank">a GitHub
repo</a> and it can also be
installed <a href="https://pypi.org/project/visual-selection/" rel="noopener noreferrer" target="_blank">from PyPi</a> using
<code>pipx</code>.</p>
<p>Expect it to be my tinker project of choice for a wee while; there's a
couple of other things I'd like to add to it.</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:95-1">
<p>Possibly unpopular opinion with some folk who will read this, but I've
long been a fan of Ruby as a language and actually generally prefer it
to Python.&#160;<a class="footnote-backref" href="#fnref:95-1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:95-2">
<p>Me, the coder. While utterly missing the point of a simple
illustration, while apparently not understanding the concept of an
analogy, I guess at least they felt I was intelligent?&#160;<a class="footnote-backref" href="#fnref:95-2" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
</ol>
</div>
        </div>
        
        <div class="tags">
            
            <a href="/tag/python.html" class="tag">Python</a>
            
            <a href="/tag/evolution.html" class="tag">evolution</a>
            
            <a href="/tag/biology.html" class="tag">biology</a>
            
            <a href="/tag/terminal.html" class="tag">terminal</a>
            
            <a href="/tag/textual.html" class="tag">textual</a>
            
        </div>
        
    </article>
    
    
    
    
    
    
</div>

            </main>

            <footer>
                <p>Generated with <a href="https://github.com/davep/blogmore" target="_blank" rel="noopener noreferrer">Blogmore</a></p>
            </footer>
        </div>
    </div>
</body>
</html>