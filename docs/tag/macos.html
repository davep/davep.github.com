
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="all" />

  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="https://blog.davep.org/theme/stylesheet/style.min.css">

    <link id="dark-theme-style" rel="stylesheet" type="text/css"
          media="(prefers-color-scheme: dark), (prefers-color-scheme: no-preference)"
    href="https://blog.davep.org/theme/stylesheet/dark-theme.min.css">

    <link id="pygments-dark-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: dark), (prefers-color-scheme: no-preference)"
          href="https://blog.davep.org/theme/pygments/monokai.min.css">
    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: light)"
          href="https://blog.davep.org/theme/pygments/github.min.css">



  <link rel="stylesheet" type="text/css" href="https://blog.davep.org/theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="https://blog.davep.org/theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="https://blog.davep.org/theme/font-awesome/css/solid.css">

  <link rel="stylesheet" type="text/css" href="https://blog.davep.org/static/davep.css">

  <link rel="shortcut icon" href="/static/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/static/favicon.ico" type="image/x-icon">


  <link href="https://blog.davep.org/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="blog.davep.org Atom">

  <link href="https://blog.davep.org/feed.xml" type="application/rss+xml" rel="alternate" title="blog.davep.org RSS">







 

    <meta name="author" content="Dave Pearson" />
    <meta name="description" content="" />
  <meta property="og:site_name" content="blog.davep.org"/>
  <meta property="og:type" content="blog"/>
  <meta property="og:title" content="blog.davep.org"/>
  <meta property="og:description" content=""/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:url" content="https://blog.davep.org"/>
  <meta property="og:image" content="/static/davep.jpeg">

  <title>blog.davep.org &ndash; Tag macOS</title>


</head>
<body >

<aside>
  <div>
    <a href="https://blog.davep.org/">
      <img src="/static/davep.jpeg" alt="davep" title="davep">
    </a>

    <h1>
      <a href="https://blog.davep.org/">davep</a>
    </h1>

    <p>Code, Emacs, VR, Stuff...</p>


    <nav>
      <ul class="list">


            <li>
              <a target="_blank"
                 href="https://blog.davep.org/pages/about.html#about">
                About
              </a>
            </li>
            <li>
              <a target="_blank"
                 href="https://blog.davep.org/pages/dot-files.html#dot-files">
                Dot Files
              </a>
            </li>

          <li>
            <a target="_blank" href="http://davep.at/" >davep@</a>
          </li>
          <li>
            <a target="_blank" href="https://pinboard.in/u:davep" >Pinboard</a>
          </li>
          <li>
            <a target="_blank" href="https://seenbydavep.blogspot.com/" >Photoblog</a>
          </li>
          <li>
            <a target="_blank" href="https://elisp.dev/" >Emacs Packages</a>
          </li>
          <li>
            <a target="_blank" href="https://pypi.org/user/davepearson/" >Python Packages</a>
          </li>
      </ul>
    </nav>

    <ul class="social">
      <li>
        <a class="sc-github"
           href="https://github.com/davep"
           target="_blank">
          <i class="fa-brands fa-github"></i>
        </a>
      </li>
      <li>
        <a class="sc-mastodon"
rel="me"           href="https://fosstodon.org/@davep"
           target="_blank">
          <i class="fa-brands fa-mastodon"></i>
        </a>
      </li>
      <li>
        <a class="sc-flickr"
           href="https://www.flickr.com/photos/davepearson/"
           target="_blank">
          <i class="fa-brands fa-flickr"></i>
        </a>
      </li>
      <li>
        <a class="sc-lastfm"
           href="https://www.last.fm/user/davepdotorg"
           target="_blank">
          <i class="fa-brands fa-lastfm"></i>
        </a>
      </li>
      <li>
        <a class="sc-npm"
           href="https://www.npmjs.com/~davep.org"
           target="_blank">
          <i class="fa-brands fa-npm"></i>
        </a>
      </li>
      <li>
        <a class="sc-youtube"
           href="https://www.youtube.com/user/daveporg"
           target="_blank">
          <i class="fa-brands fa-youtube"></i>
        </a>
      </li>
      <li>
        <a class="sc-steam"
           href="https://steamcommunity.com/id/davepdotorg"
           target="_blank">
          <i class="fa-brands fa-steam"></i>
        </a>
      </li>
    </ul>
  </div>

</aside>
  <main>

<nav>
  <a href="https://blog.davep.org/">Home</a>

  <a href="/archives.html">Archives</a>
  <a href="/categories.html">Categories</a>
  <a href="/tags.html">Tags</a>

  <a href="https://blog.davep.org/feeds/all.atom.xml">Atom</a>

  <a href="https://blog.davep.org/feed.xml">RSS</a>
</nav>



<article>
  <header>
    <h2><a href="https://blog.davep.org/2023/07/14/cmd-tab-switcher-on-all-screens.html#cmd-tab-switcher-on-all-screens">Cmd-Tab switcher on all screens</a></h2>
    <p>
      Posted on 2023-07-14 07:56 +0100 in <a href="https://blog.davep.org/category/til.html">TIL</a>

          &#8226; Tagged with
              <a href="https://blog.davep.org/tag/apple.html">Apple</a>,              <a href="https://blog.davep.org/tag/mac.html">Mac</a>,              <a href="https://blog.davep.org/tag/macos.html">macOS</a>,              <a href="https://blog.davep.org/tag/work.html">Work</a>
        &#8226; 2 min read
    </p>
  </header>
  <div>
      <div><p>This week, on Monday gone in fact, <a href="https://www.textualize.io/">we</a> moved
office. We've now got a bigger space and, as part of that, bigger desks.
Somewhat (but not entirely) coincidentally the work desk will also convert
into a standing desk<sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup>. Also also... I inherited a second screen for the
desk too. Ever since the days of CRTs and video cards that supported it,
I've been a fan of having at least a couple of screens in front of me, and
now at my work desk I've got 3 (two external displays and the display of the
MacBook Pro itself).</p>
<p>This caused a slight problem though: horizontally there's quite the spread
of things to look at. This is fine, mostly I'm looking at the screen that's
in front of me; the MacBook is to the left and the "second" screen is to the
right, both with "other" stuff on them. In front of me is Emacs and my
browser, which I flip between lots.</p>
<p>The problem is this: the MacBook needs to go to the left (because of
physical layout), which means that despite me setting the screen in front of
me as the "main" screen, the <kbd>Cmd</kbd>-<kbd>Tab</kbd> display (you know
the thing: when you hit <kbd>Cmd</kbd>-<kbd>Tab</kbd> you see the icons of
all your active applications) appears on the left-most display, which is the
MacBook.</p>
<p>Not great. If I'm looking at the right-most display, and want to switch
using the keyboard, I've got to look over to the left, as a worst case. That
makes for a lot of unnecessary head-swivelling.</p>
<p>One quick Google later and <em>Today I Learnt</em> that the following pretty much
solves the problem:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>defaults<span class="w"> </span>write<span class="w"> </span>com.apple.Dock<span class="w"> </span>appswitcher-all-displays<span class="w"> </span>-bool<span class="w"> </span><span class="nb">true</span>
$<span class="w"> </span>killall<span class="w"> </span>Dock
</code></pre></div>

<p>As the name of the setting would suggest: once done, the switcher appears on
<em>all</em> displays.</p>
<p>That's perfect.</p>
<div class="footnote">
<hr>
<ol>
<li id="fn:1">
<p>Although the work one is manual hand-cranked, not electronic
button-push goodness like <a href="2023/07/08/new-desk.html">my new one at
home</a>.&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div></div>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="https://blog.davep.org/2022/11/05/python-and-macos.html#python-and-macos">Python and macOS</a></h2>
    <p>
      Posted on 2022-11-05 08:49 +0000 in <a href="https://blog.davep.org/category/python.html">Python</a>

          &#8226; Tagged with
              <a href="https://blog.davep.org/tag/python.html">Python</a>,              <a href="https://blog.davep.org/tag/macos.html">macOS</a>,              <a href="https://blog.davep.org/tag/coding.html">coding</a>
        &#8226; 5 min read
    </p>
  </header>
  <div>
      <div><h1>Introduction</h1>
<p>On Twitter, a few weeks back, <a href="https://twitter.com/itsBexli/status/1577332548933500928">@itsBexli asked me how I go about setting up
Python for development on
macOS</a>. It's a
great question and one that seems to crop up in various places, and since <a href="/2015/06/27/my-first-couple-of-weeks-with-an-imac.html">I
first got into using
macOS</a> and then
<a href="/2017/12/12/on_to_something_new.html">subsequently got back into coding lots in
Python</a> it's absolutely an issue I ran
into.</p>
<p>With my previous employer, while I was the only developer, I wasn't the only
person writing code and more than one other person had this issue so I
eventually wrote up my approach to solving this problem. That document is on
their internal GitLab, but I thought it worth me writing my personal
macOS/Python "rules" up again, just in case they're useful to anyone else.</p>
<p>I am, of course, not the first person to tackle this, to document this, to
write down a good approach to this. Before and after I settled on my
approach I'd seen other people write about this. So... this post isn't here
to try and replace those, it's simply to write down my own approach, so if
anyone asks again I can point them here. I feel it's important to stress:
this isn't the only way or thoughts on this issue, there are lots of others.
Do go read them too and then settle on an approach that works for you.</p>
<p>One other point to note, which may or may not make a difference (and may or
may not affect how this changes with time): for the past few years I've been
a heavy user of <a href="https://pipenv.pypa.io/en/latest/"><code>pipenv</code></a> to manage my
virtual environments. This is very likely to change from now on, but keep in
mind that what follows was arrived at from the perspective of a <code>pipenv</code>
user.</p>
<p>So... with that admin aside...</p>
<h1>The Problem</h1>
<p>When I first got back into writing Python it was on macOS and, really early
on, I ran into all the usual issues: virtual environments breaking because
they were based on the system Python and it got updated, virtual
environments based on the Homebrew-installed Python and it got updated,
etc... Simply put, an occasional, annoying, non-show-stopping breaking of my
development environment which would distract me when I'd sat down to just
hack on some code, not do system admin!</p>
<h1>My Solution</h1>
<p>For me, what's worked for me without a problem over the past few years, in
short, is this:</p>
<ol>
<li><strong>NEVER</strong> use the system version of Python. Just don't.</li>
<li><strong>NEVER</strong> use the Homebrew's own version of Python (I'm not even sure
   this is an issue any more; but it used to be).</li>
<li><strong>NEVER</strong> use a version of Python installed with Homebrew (or, more to
   the point, never install Python with Homebrew).</li>
<li>Manage everything with <a href="https://github.com/pyenv/"><code>pyenv</code></a>; which I do
   install from Homebrew.</li>
</ol>
<h1>The Detail</h1>
<p>As mentioned earlier, what I'm writing here assumes that virtual
environments are being managed with <code>pipenv</code> (something I still do for
personal projects, for now, but this may change soon). Your choices and
mileage may vary, etc... This is what works well for me.</p>
<h2>The "one time" items</h2>
<p>These are the items that need initially installing into a new macOS machine:</p>
<h3>Homebrew</h3>
<p>Unless it comes from the Mac App Store, I try and install everything via
<a href="https://brew.sh/">Homebrew</a>. It's really handy for keeping track of what
I've got installed, for recreating a development environment in general, and
for keeping things up to date.</p>
<h3>pyenv</h3>
<p>With Homebrew installed the next step for me is to install <code>pyenv</code>. Doing so
is as easy as:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>brew<span class="w"> </span>install<span class="w"> </span>pyenv
</code></pre></div>

<p>Once installed, if it's not done it for you, you may need to make some
changes to your login profile. I'm a user of <a href="https://fishshell.com">fish</a>
so I have <a href="https://github.com/davep/fish/blob/efc77fd20c4bd2f36eb628730787924b6a56fcfd/conf.d/python.fish#L21-L25">these lines in my
setup</a>.
Simply put: it asks pyenv to set up my environment so my calls to Python go
via its setup.</p>
<p>Plenty of help on how to set up <code>pyenv</code> can be found <a href="https://github.com/pyenv/pyenv#installation">in its
README</a>.</p>
<p>Once I've done this I tend to go on and install the Python versions I'm
likely to need. For me this tends to be the most recent "active" stable
versions (as of the time of writing, 3.7 through 3.10; although I need to
now start throwing 3.11 into the mix too).</p>
<p>I use this command:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>pyenv<span class="w"> </span>install<span class="w"> </span>--list
</code></pre></div>

<p>to see the available versions. If I want to see what's available for a
specific version I'll pipe through grep:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>pyenv<span class="w"> </span>install<span class="w"> </span>--list<span class="w"> </span><span class="p">|</span><span class="w"> </span>fgrep<span class="w"> </span><span class="s2">&quot;  3.9&quot;</span>
</code></pre></div>

<p>This is handy if I want to check what the very latest release of a specific
version of Python is.</p>
<h3>The "Global" Python</h3>
<p>When I'm done with the above I then tend to use <code>pyenv</code> to set my "global"
Python. This is the version I want to get when I run <code>python</code> and I'm not
inside a virtual environment. Doing that is as simple as:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>pyenv<span class="w"> </span>global<span class="w"> </span><span class="m">3</span>.10.7
</code></pre></div>

<p>Of course, you'd swap the version for whatever works for you.</p>
<h3>When Stuff Breaks</h3>
<p>It seems more rare these days, but on occasion I've had it such that some
update somewhere still causes my environment to break. Now though I find
that all it takes is a quick:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>pyenv<span class="w"> </span>rehash
</code></pre></div>

<p>and everything is good again.</p>
<h2>Setting Up A Repo</h2>
<p>With all of the stuff above being mostly a one-off (or at least something I
do once when I set up a new machine -- which isn't often), the real "work"
here is when I set up a fresh repository when I start a new project. Really
it's no work at all. Again, as I've said before, I've tended to use <code>pipenv</code>
for my own work, and still do for personal stuff (but do want to change
that), mileage may vary here depending on tool.</p>
<p>When I start a new project I think about which Python version I want to be
working with, I ensure I have the latest version of it installed with
<code>pyenv</code>, and then ask <code>pipenv</code> to create a new virtual environment with
that:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>pipenv<span class="w"> </span>--python<span class="w"> </span><span class="m">3</span>.10.7
</code></pre></div>

<p>When you do this, you should see <code>pipenv</code> pulling the version of Python from
the <code>pyenv</code> directories:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>pipenv<span class="w"> </span>--python<span class="w"> </span><span class="m">3</span>.10.7
Creating<span class="w"> </span>a<span class="w"> </span>virtualenv<span class="w"> </span><span class="k">for</span><span class="w"> </span>this<span class="w"> </span>project...
Pipfile:<span class="w"> </span>/Users/davep/temp/cool-project/Pipfile
Using<span class="w"> </span>/Users/davep/.pyenv/versions/3.10.7/bin/python3<span class="w"> </span><span class="o">(</span><span class="m">3</span>.10.7<span class="o">)</span><span class="w"> </span>to<span class="w"> </span>create<span class="w"> </span>virtualenv...
⠙<span class="w"> </span>Creating<span class="w"> </span>virtual<span class="w"> </span>environment...created<span class="w"> </span>virtual<span class="w"> </span>environment<span class="w"> </span>CPython3.10.7.final.0-64<span class="w"> </span><span class="k">in</span><span class="w"> </span>795ms
<span class="w">  </span>creator<span class="w"> </span>CPython3Posix<span class="o">(</span><span class="nv">dest</span><span class="o">=</span>/Users/davep/temp/cool-project/.venv,<span class="w"> </span><span class="nv">clear</span><span class="o">=</span>False,<span class="w"> </span><span class="nv">no_vcs_ignore</span><span class="o">=</span>False,<span class="w"> </span><span class="nv">global</span><span class="o">=</span>False<span class="o">)</span>
<span class="w">  </span>seeder<span class="w"> </span>FromAppData<span class="o">(</span><span class="nv">download</span><span class="o">=</span>False,<span class="w"> </span><span class="nv">pip</span><span class="o">=</span>bundle,<span class="w"> </span><span class="nv">setuptools</span><span class="o">=</span>bundle,<span class="w"> </span><span class="nv">wheel</span><span class="o">=</span>bundle,<span class="w"> </span><span class="nv">via</span><span class="o">=</span>copy,<span class="w"> </span><span class="nv">app_data_dir</span><span class="o">=</span>/Users/davep/Library/Application<span class="w"> </span>Support/virtualenv<span class="o">)</span>
<span class="w">    </span>added<span class="w"> </span>seed<span class="w"> </span>packages:<span class="w"> </span><span class="nv">pip</span><span class="o">==</span><span class="m">22</span>.2.2,<span class="w"> </span><span class="nv">setuptools</span><span class="o">==</span><span class="m">65</span>.3.0,<span class="w"> </span><span class="nv">wheel</span><span class="o">==</span><span class="m">0</span>.37.1
<span class="w">  </span>activators<span class="w"> </span>BashActivator,CShellActivator,FishActivator,NushellActivator,PowerShellActivator,PythonActivator
✔<span class="w"> </span>Successfully<span class="w"> </span>created<span class="w"> </span>virtual<span class="w"> </span>environment!
Virtualenv<span class="w"> </span>location:<span class="w"> </span>/Users/davep/temp/cool-project/.venv
Creating<span class="w"> </span>a<span class="w"> </span>Pipfile<span class="w"> </span><span class="k">for</span><span class="w"> </span>this<span class="w"> </span>project...
</code></pre></div>

<p>The key thing here is seeing that <code>pipenv</code> is pulling Python from
<code>~/.pyenv/versions/</code>. If it isn't there's a good chance you have a Python
earlier in your <code>PATH</code> than the <code>pyenv</code> one -- something you generally don't
want. It will work, but it's more likely to break at some point in the
future. That's the key thing I look for; if I see that I know things are
going to be okay.</p>
<h2>Conclusion</h2>
<p>Since I adopted these personal rules and approaches (and really, calling
them "rules" is kind of grand -- there's almost nothing to this) I've found
I've had near-zero issues with the stability of my Python virtual
environments (and what issues I have run into tend to be trivial and of my
own doing).</p>
<p>As I said at the start: there are, of course, other approaches to this, but
this is mine and works well for me. Do feel free to comment with your own,
I'm always happy to learn about new ways!</p></div>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="https://blog.davep.org/2020/07/10/when-the-man-page-fibs.html#when-the-man-page-fibs">When the man page fibs</a></h2>
    <p>
      Posted on 2020-07-10 20:58 +0100 in <a href="https://blog.davep.org/category/coding.html">Coding</a>

          &#8226; Tagged with
              <a href="https://blog.davep.org/tag/homebrew.html">homebrew</a>,              <a href="https://blog.davep.org/tag/macos.html">macOS</a>,              <a href="https://blog.davep.org/tag/unix.html">Unix</a>,              <a href="https://blog.davep.org/tag/python.html">Python</a>
        &#8226; 3 min read
    </p>
  </header>
  <div>
      <div><p>Earlier this week something in my development environment, relating to
<a href="https://brew.sh/">Homebrew</a>, Python,
<a href="https://github.com/pyenv/pyenv">pyenv</a> and
<a href="https://pipenv.pypa.io/en/latest/">pipenv</a>, got updated and broke a handful
of repositories. Not in a way that I couldn't recover from, just in a way
that was annoying, got in the way of my workflow, and needed attention.
<em>(note to self: how I set up for Python/Django development on a machine
might be a good post in the future)</em></p>
<p>Once I was sure what the fix was (pretty much: nuke the virtual environment
and recreate it with <code>pipenv</code>, being very explicit about the version of
Python to use) the next step was to figure out how many repositories were
affected; not all were and there wasn't an obvious pattern to it. What was
obvious was that the problem came down to <code>python</code> in the <code>.venv</code> directory
pointing to a binary that didn't exist any more.</p>
<p><img alt="Screenshot 2020-07-10 at 20.21.15.png" src="/attachments/2020/07/10/Screenshot 2020-07-10 at 20.21.15.png"></p>
<p>So... tracking down problematic repositories would be simple enough, just
look for every instance of <code>.venv/bin/python</code> and be sure it points to
something rather than nothing; if it points to nothing I need to remake the
virtual environment.</p>
<p>I quickly knocked up a script that was based around looking over the results
of a <code>find</code>, and initially decided to use <code>file</code> to perform the test on
<code>python</code>. It seemed to make sense, as I wrote the script I checked the <code>man</code>
page for <code>file(1)</code> on macOS and sure enough, this exists:</p>
<blockquote>
<p>-E On filesystem errors (file not found etc), instead of handling the error as regular output as POSIX mandates and keep going, issue an error message and exit.</p>
</blockquote>
<p>Given that <code>file</code> dereferences links by default, that should get me an error
for a broken link, right? Bit hacky I guess, but it was the first thing that
came to mind for a quick bit of scripting and would do the trick. Only...</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>file<span class="w"> </span>-E<span class="w"> </span>does-not-exist
file:<span class="w"> </span>invalid<span class="w"> </span>option<span class="w"> </span>--<span class="w"> </span>E
Usage:<span class="w"> </span>file<span class="w"> </span><span class="o">[</span>bcCdEhikLlNnprsvzZ0<span class="o">]</span><span class="w"> </span><span class="o">[</span>-e<span class="w"> </span>test<span class="o">]</span><span class="w"> </span><span class="o">[</span>-f<span class="w"> </span>namefile<span class="o">]</span><span class="w"> </span><span class="o">[</span>-F<span class="w"> </span>separator<span class="o">]</span><span class="w"> </span><span class="o">[</span>-m<span class="w"> </span>magicfiles<span class="o">]</span><span class="w"> </span><span class="o">[</span>-M<span class="w"> </span>magicfiles<span class="o">]</span><span class="w"> </span>file...
<span class="w">       </span>file<span class="w"> </span>-C<span class="w"> </span>-m<span class="w"> </span>magicfiles
Try<span class="w"> </span><span class="sb">`</span>file<span class="w"> </span>--help<span class="err">&#39;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>more<span class="w"> </span>information.
</code></pre></div>

<p><a href="https://www.destroyallsoftware.com/talks/wat">Wat</a>?!? But it's right there! It says so in the manual! <code>-E</code> is documented right in the manual page! And yet it's not in the valid switch list as put out by the command, <em>and</em> it's an <code>invalid option</code>. The hell?</p>
<p>So I go back and look at the <code>man</code> page again and then I notice it isn't in
the list of switches in the synopsis.</p>
<blockquote>
<p>SYNOPSIS<br>
    file [-bcdDhiIkLnNprsvz] [--extension] [--mime-encoding] [--mime-type] [-f namefile] [-m magicfiles] [-P name=value] [-M magicfiles] file<br>
    file -C [-m magicfiles]<br>
    file [--help]  </p>
</blockquote>
<p>I then did the obvious tests. Did I have <code>file</code> aliased in some way? No. Was
some other thing that works and acts like <code>file</code> in my path? No. Was I
absolutely 100% using <code>/usr/bin/file</code>? Yes.</p>
<p>Long story short: it seems the <code>man</code> page for <code>file</code>, on macOS, fibs about
what switches it supports; it says that <code>-E</code> is a valid option, but it's not
there.</p>
<p>What's even odder is the man page says it documents v5.04 of the command,
but <code>--version</code> reports v5.37. Meanwhile, if I check on a GNU/Linux box I
have access to, it does support <code>-E</code>, reports it in the switches, documents
it in the <code>man</code> page (in both the synopsis and in the main body of the page)
and it is v5.25 (and so is its man page).</p>
<p>So that was something like 20 minutes lost to a very small problem, for
which there was no real solution, but was time that had to be spent to get
to the bottom of it.</p>
<p>In the end I went with what I probably should have gone with in the first
place: <code>stat -L</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">for</span><span class="w"> </span>venv<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">$(</span>find<span class="w"> </span>.<span class="w"> </span>-name<span class="w"> </span>.venv<span class="k">)</span>
<span class="k">do</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span>!<span class="w"> </span>stat<span class="w"> </span>-L<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$venv</span><span class="s2">/bin/python&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
<span class="w">    </span><span class="k">then</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>dirname<span class="w"> </span><span class="nv">$venv</span><span class="k">)</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="k">fi</span>
<span class="k">done</span>
</code></pre></div>

<p>And now I have that script in my <code>~/bin</code> directory, ready for the next time
Homebrew and friends conspire to throw my day off for a while.</p></div>
  </div>
</article>

  <div class="pagination">
  </div>



<footer>
<p>&copy; 2015-2023 Dave Pearson</p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
  <span class="footer-separator">|</span>
  Switch to the <a href="javascript:void(0)" onclick="theme.switch(`dark`)">dark</a> | <a href="javascript:void(0)" onclick="theme.switch(`light`)">light</a> | <a href="javascript:void(0)" onclick="theme.switch(`browser`)">browser</a> theme
  <script id="dark-theme-script"
          src="https://blog.davep.org/theme/dark-theme/dark-theme.min.js"
          data-enable-auto-detect-theme="True"
          data-default-theme="dark"
          type="text/javascript">
  </script>
</p></footer>  </main>

<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " blog.davep.org ",
  "url" : "https://blog.davep.org",
  "image": "/static/davep.jpeg",
  "description": ""
}
</script>
</body>
</html>