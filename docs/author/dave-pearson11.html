
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="all" />

  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="https://blog.davep.org/theme/stylesheet/style.min.css">

    <link id="dark-theme-style" rel="stylesheet" type="text/css"
          media="(prefers-color-scheme: dark), (prefers-color-scheme: no-preference)"
    href="https://blog.davep.org/theme/stylesheet/dark-theme.min.css">

    <link id="pygments-dark-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: dark), (prefers-color-scheme: no-preference)"
          href="https://blog.davep.org/theme/pygments/monokai.min.css">
    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: light)"
          href="https://blog.davep.org/theme/pygments/github.min.css">



  <link rel="stylesheet" type="text/css" href="https://blog.davep.org/theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="https://blog.davep.org/theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="https://blog.davep.org/theme/font-awesome/css/solid.css">

  <link rel="stylesheet" type="text/css" href="https://blog.davep.org/static/davep.css">

  <link rel="shortcut icon" href="/static/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/static/favicon.ico" type="image/x-icon">


  <link href="https://blog.davep.org/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="blog.davep.org Atom">

  <link href="https://blog.davep.org/feed.xml" type="application/rss+xml" rel="alternate" title="blog.davep.org RSS">







 

    <meta name="author" content="Dave Pearson" />
    <meta name="description" content="" />
  <meta property="og:site_name" content="blog.davep.org"/>
  <meta property="og:type" content="blog"/>
  <meta property="og:title" content="blog.davep.org"/>
  <meta property="og:description" content=""/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:url" content="https://blog.davep.org"/>
  <meta property="og:image" content="/static/davep.jpeg">

  <title>blog.davep.org &ndash; Posts by Dave Pearson:</title>


</head>
<body >

<aside>
  <div>
    <a href="https://blog.davep.org/">
      <img src="/static/davep.jpeg" alt="davep" title="davep">
    </a>

    <h1>
      <a href="https://blog.davep.org/">davep</a>
    </h1>

    <p>Code, Emacs, VR, Stuff...</p>


    <nav>
      <ul class="list">


            <li>
              <a target="_blank"
                 href="https://blog.davep.org/pages/about.html#about">
                About
              </a>
            </li>
            <li>
              <a target="_blank"
                 href="https://blog.davep.org/pages/dot-files.html#dot-files">
                Dot Files
              </a>
            </li>

          <li>
            <a target="_blank" href="http://davep.at/" >davep@</a>
          </li>
          <li>
            <a target="_blank" href="https://pinboard.in/u:davep" >Pinboard</a>
          </li>
          <li>
            <a target="_blank" href="https://seenbydavep.blogspot.com/" >Photoblog</a>
          </li>
          <li>
            <a target="_blank" href="https://elisp.dev/" >Emacs Packages</a>
          </li>
          <li>
            <a target="_blank" href="https://pypi.org/user/davepearson/" >Python Packages</a>
          </li>
      </ul>
    </nav>

    <ul class="social">
      <li>
        <a class="sc-github"
           href="https://github.com/davep"
           target="_blank">
          <i class="fa-brands fa-github"></i>
        </a>
      </li>
      <li>
        <a class="sc-mastodon"
rel="me"           href="https://fosstodon.org/@davep"
           target="_blank">
          <i class="fa-brands fa-mastodon"></i>
        </a>
      </li>
      <li>
        <a class="sc-flickr"
           href="https://www.flickr.com/photos/davepearson/"
           target="_blank">
          <i class="fa-brands fa-flickr"></i>
        </a>
      </li>
      <li>
        <a class="sc-lastfm"
           href="https://www.last.fm/user/davepdotorg"
           target="_blank">
          <i class="fa-brands fa-lastfm"></i>
        </a>
      </li>
      <li>
        <a class="sc-npm"
           href="https://www.npmjs.com/~davep.org"
           target="_blank">
          <i class="fa-brands fa-npm"></i>
        </a>
      </li>
      <li>
        <a class="sc-youtube"
           href="https://www.youtube.com/user/daveporg"
           target="_blank">
          <i class="fa-brands fa-youtube"></i>
        </a>
      </li>
      <li>
        <a class="sc-steam"
           href="https://steamcommunity.com/id/davepdotorg"
           target="_blank">
          <i class="fa-brands fa-steam"></i>
        </a>
      </li>
    </ul>
  </div>

</aside>
  <main>

<nav>
  <a href="https://blog.davep.org/">Home</a>

  <a href="/archives.html">Archives</a>
  <a href="/categories.html">Categories</a>
  <a href="/tags.html">Tags</a>

  <a href="https://blog.davep.org/feeds/all.atom.xml">Atom</a>

  <a href="https://blog.davep.org/feed.xml">RSS</a>
</nav>



<article>
  <header>
    <h2><a href="https://blog.davep.org/2019/10/18/time-to-move-on.html#time-to-move-on">Time to move on</a></h2>
    <p>
      Posted on 2019-10-18 17:42 +0100 in <a href="https://blog.davep.org/category/meta.html">Meta</a>

          &#8226; Tagged with
              <a href="https://blog.davep.org/tag/blogging.html">blogging</a>
        &#8226; 2 min read
    </p>
  </header>
  <div>
      <div><p>It's well over a year since I last wrote something on this blog. As
mentioned in the last post (and the one before), it's not for bad reasons or
anything like that. Being in a new job, which actually isn't all that new
now, has kept me busy in all the best ways possible.</p>
<p>There's been other stuff going on too which has drawn on my attention and
the time and motivation to blog, either random stuff, or more
development-related stuff, just hasn't been there.</p>
<p>Also... blogging via GitHub, using Jekyll, has lost a lot of its shine. It
sort of makes sense, well, sort of <em>made</em> sense, but in the end it felt like
more work than it should. Whereas most blogging systems tend to encourage
just diving in and banging on the keyboard, there's just a bit more faff
with the GitHub pages approach.</p>
<p>So, with that in mind, and with no desire right now to roll my own (which
would be fun, it has to be said), I'm going to <a href="https://blog.davep.dev/">skip off over to Hashnode's
blogging system</a>. It seems to have everything I'd
want and I can slap it on a domain of mine.</p>
<p>Most of my random musings about random things really happen on Twitter, so I
can't imagine I'll be wanting to blog about normal/mundane things. What I
would like to do is write about development-related things from time to
time. So that would seem to fit even better.</p>
<p>Anyway, enough of all this waffle. If you land here and it looks kind of
quiet, that's because it has been quiet for a while and I'm now going to try
and concentrate elsewhere, with a wish to do some coding-related writing now
and again.</p></div>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="https://blog.davep.org/2018/06/02/a_little_speed_issue_with_openpyxl.html#a_little_speed_issue_with_openpyxl">A little speed issue with openpyxl</a></h2>
    <p>
      Posted on 2018-06-02 13:16 +0100 in <a href="https://blog.davep.org/category/python.html">Python</a>

          &#8226; Tagged with
              <a href="https://blog.davep.org/tag/python.html">Python</a>,              <a href="https://blog.davep.org/tag/openpyxl.html">openpyxl</a>
        &#8226; 4 min read
    </p>
  </header>
  <div>
      <div><p>It's been very quiet on the blogging front, I'm afraid, mostly for <a href="/2017/12/12/on_to_something_new.html">the
reasons I wrote about back in December last
year</a>. In that time I've been really
very busy with work (in a good way, in a <em>very</em> good way) and there's not a
whole lot of time to be toying with pet projects at home.</p>
<p>However, finding myself with a spare hour or so, I wanted to write about
something I did run into as part of some development at work, and which I
thought might be worth writing about in case it helps someone else.</p>
<p>Recently I've needed to write a library of code for loading data from Excel
Workbooks. Given that the vast majority of coding I do at the moment is in
Python, it made sense to make use of
<a href="https://openpyxl.readthedocs.io/">openpyxl</a>. The initial prototype code I
wrote worked well and it soon grew into a full-blown library that'll be used
in a couple of work-related projects.</p>
<p>But one thing kept niggling me... It just wasn't as fast as I'd expected.
The workbooks I'm pulling data from aren't that large, and yet it was taking
a noticeable number of seconds to read in the data, and when I let the code
have a go at a directory full of such workbooks... even the fan on the
machine would ramp up.</p>
<p>It didn't seem right.</p>
<p>I did a little bit of profiling and could see that the code was spending
most of its time deep in the guts of some XML-parsing functions. While I
know that an <code>xlsx</code> file is pretty much an XML document, it seemed odd to me
that it would take so much time and effort to pull the data out from it.</p>
<p>Given that I had other code to be writing, and given that the
workbook-parsing code was "good enough" for the moment, I moved on for a
short while.</p>
<p>But, a couple of weeks back, I had a bit of spare time and decided to
revisit it. I did some more searching on openpyxl and speed issues and
almost everything I found said that the common problem was failing to open
the workbook in <code>read_only</code> mode. That can't have been my problem because
I'd being doing that from the very start.</p>
<p>Eventually I came across a post somewhere (sorry, I've lost it for now --
I'll try and track it down again) that suggested that openpyxl was very slow
to read from a workbook if you were reading one cell at a time, rather than
using generators. The suggestion being that every time you pull a value form
a cell, it has to parse the whole sheet up to that cell. Generators, on the
other hand, would allow access to all the cells during one parse.</p>
<p>This seemed a little unlikely to me -- I'd have expected the code to cache
the parsing results or something like that -- but it also would explain what
I was seeing. So I decided to give it a test.</p>
<p><a href="https://github.com/davep/openpyxl-speed-issue"><code>openpyxl-speed-issue</code></a> is a
version of the tests I wrote and ran and they absolutely show that there's a
huge difference between cell-by-cell access vs generator access.</p>
<p>Code like this:</p>
<div class="highlight"><pre><span></span><code><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sheet</span><span class="o">.</span><span class="n">max_row</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">):</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sheet</span><span class="o">.</span><span class="n">max_column</span> <span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">sheet</span><span class="p">[</span> <span class="n">row</span> <span class="p">][</span> <span class="n">col</span> <span class="p">]</span><span class="o">.</span><span class="n">value</span>
</code></pre></div>

<p>is <em>far slower</em> than something like this:</p>
<div class="highlight"><pre><span></span><code><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">wb</span><span class="p">[</span> <span class="s2">&quot;Test Sheet&quot;</span> <span class="p">]</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">value</span>
</code></pre></div>

<p>Here's an example of the difference in time, as seen on my iMac:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>make<span class="w"> </span><span class="nb">test</span>
pipenv<span class="w"> </span>run<span class="w"> </span><span class="nb">time</span><span class="w"> </span>./read-using-generators
<span class="w">        </span><span class="m">1</span>.59<span class="w"> </span>real<span class="w">         </span><span class="m">0</span>.44<span class="w"> </span>user<span class="w">         </span><span class="m">0</span>.04<span class="w"> </span>sys
pipenv<span class="w"> </span>run<span class="w"> </span><span class="nb">time</span><span class="w"> </span>./read-using-peeking
<span class="w">       </span><span class="m">25</span>.02<span class="w"> </span>real<span class="w">        </span><span class="m">24</span>.88<span class="w"> </span>user<span class="w">         </span><span class="m">0</span>.10<span class="w"> </span>sys
</code></pre></div>

<p>As you can see, the cell-by-cell approach is about 16 times slower than the
generator approach.</p>
<p>In most circumstances the generator approach would make most sense anyway,
and in any other situation I probably would have used it and never have
noticed this. However, the nature of the workbooks I need to pull data from
means I need to "peek ahead" to make decisions about what I'm doing, so a
more traditional loop over, with an index, made more sense.</p>
<p>I can easily "fix" this by using the generator approach to build up a
two-dimensional array of cells, acquired via the generator; so I can still
do what I want <em>and</em> benefit from using generators.</p>
<p>In conclusion: given that I found it difficult to find information about my
speed issue, and given that the one off-hand comment I saw that suggested it
was this wasn't exactly easy to find, I thought I'd write it all down too
and <a href="https://github.com/davep/openpyxl-speed-issue">create a repository of some test code to illustrate the
issue</a>. Hopefully someone
else will benefit from this in the future.</p></div>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="https://blog.davep.org/2017/12/12/on_to_something_new.html#on_to_something_new">On to something new</a></h2>
    <p>
      Posted on 2017-12-12 13:59 +0000 in <a href="https://blog.davep.org/category/life.html">Life</a>

          &#8226; Tagged with
              <a href="https://blog.davep.org/tag/coding.html">coding</a>,              <a href="https://blog.davep.org/tag/work.html">work</a>,              <a href="https://blog.davep.org/tag/life.html">life</a>,              <a href="https://blog.davep.org/tag/news.html">news</a>
        &#8226; 2 min read
    </p>
  </header>
  <div>
      <div><p>Today is a fairly significant day for me. For the past 21 (and a bit) years
I've worked for the same company. I know that, for lots of people in my
industry, that's a hell of a long time to be in one position. It was a setup
that served me pretty well; the company was small (I'm not much of a big
company person), I generally got to dictate the development tools and
direction, and I also got to work from home.</p>
<p>The working from home part was especially helpful as other life events
involved me and happened around me. The job I've been in has seen a marriage
come and go, and a move from Hampshire to Lincolnshire, and then from
Lincolnshire to Midlothian. There's been a few adventures along the way.</p>
<p>But, three months ago, I got a call to say that I was to be made redundant.
This sucked, obviously. It also appeared pretty stupid on the part of my
employer: a company that is based around software had decided it no longer
wanted an in-house software developer. A bold, and I think unwise, choice.
From this point on they've decided to only go with contract developers and
<em>only</em> contract developers from overseas (or so the story goes).</p>
<p>As it goes, things have turned out okay. Today is my last day with my old
employer and, as I'm sat here typing this out while having some lunch, I'm
actually glad that it's coming to a close and that I can get to move on.</p>
<p>I have a new employer, and will be starting in my new position during the
first week of January. It'll be very different. It'll all be different. Not
only will I be back working in an office (one where jeans and t-shirts are
the norm, thankfully!), I'm also going to be working in an industry (as a
developer still, of course) that I have no background in and no real
knowledge of. It's going to be a seriously exciting challenge.</p>
<p><img alt="New book" src="/attachments/2017/12/12/IMG_20171212_140656-01.jpeg#centre"></p>
<p>Over the next couple of weeks I've got a fair amount of background reading
(and video watching) to be doing. This isn't so much that I can get on with
the job of development (although there will be a good bit of that to do too
-- who doesn't want to be trying to understand new options for
development?), it's more about understanding the language of the industry
I'll be in and so that I can understand the needs of my users.</p>
<p>Goodbye fashion retail and all related things. Hello genetics and... well, I
don't know, I'm going to find out. :)</p></div>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="https://blog.davep.org/2017/07/13/more_revamping_of_my_emacs_config.html#more_revamping_of_my_emacs_config">More revamping of my Emacs config</a></h2>
    <p>
      Posted on 2017-07-13 15:25 +0100 in <a href="https://blog.davep.org/category/emacs.html">Emacs</a>

          &#8226; Tagged with
              <a href="https://blog.davep.org/tag/emacs.html">Emacs</a>,              <a href="https://blog.davep.org/tag/lisp.html">Lisp</a>,              <a href="https://blog.davep.org/tag/coding.html">coding</a>,              <a href="https://blog.davep.org/tag/emacs-lisp.html">Emacs Lisp</a>
        &#8226; 2 min read
    </p>
  </header>
  <div>
      <div><p>I've been pretty quiet on here since I last wrote about how I'd done a
further revamp of my Emacs config, so I thought that subject would be a good
reason to write another blog post.</p>
<p>It'll be a mostly short one, and one to muse over something that's been
bugging me for a while now: my decision to lean heavily on <code>customize</code> to
set all sorts of settings.</p>
<p>Initially,
<a href="/2016/05/26/starting_fresh_with_gnu_emacs.html">when I nuked my original config over a year ago</a>,
it seemed to make a lot of sense. Let all the tweaks and set values "hide"
in a file of their own and try and keep the hand-edited config files as
small and as clean as possible. Recently though I've got to thinking that
this obscures too much, hides too much detail, and removes the ability to
actually document what I'm doing and why. It also does make it tricky to
adapt some settings to different platforms or even environments on a single
platform.</p>
<p>Another problem I've run into is
this:
<a href="/2017/04/01/another_revamp_of_my_emacs_config.html">when I made the second round of changes</a> and
decided to lean heavily
on <a href="https://github.com/jwiegley/use-package"><code>use-package</code></a>, I soon ran into
the minor issue of some packages not making sense, or even being needed, on
some platforms (stuff that's useful on my macOS machines isn't always useful
on my Windows machines, that sort of thing). While <code>use-package</code> can handle
this easily thanks to the <code>:if</code> keyword, I'm still left with the fact that
<code>package-selected-packages</code> still gets populated.</p>
<p>Having <code>package-selected-packages</code> contain a list of installed packages
likely makes sense if you're using just the Emacs package system and you're
not doing the installing with <code>use-package</code> and <code>:ensure</code>. But with
<code>use-package</code> and <code>:ensure</code> I feel like I've got far more control over
things and can adapt what gets installed when depending on which Emacs I'm
running where.</p>
<p>But, because I'm syncing my <code>~/.emacs.d/.custom.el</code> to all my machines too, any
<code>use-package</code> that has a <code>:if</code> to not bother using a package has little
effect because the package still ends up being listed/loaded/seen as part of
the installation.</p>
<p>Ideally, I think, I'd like to be able to have <code>package-selected-packages</code>
held in its own file, or I'd only ever use <code>~/.emacs.d/.custom.el</code> for local
stuff (and so stop syncing it).</p>
<p>Starting today I'm going about a process of moving as much as I can out of
<code>~/.emacs.d/.custom.el</code> and into hand-edited files. In some respects I guess
I am going back to how I used to manage Emacs configuration, but this time
it's not a massive monolithic file-of-Lisp, it's neatly broken down into
sensible sections and it's also biased towards a "grab and config this
package" approach.</p>
<p>Meanwhile, I've not seen any good discussions online about <code>customize</code> vs
"hand-edit", which strikes me as a little odd as it feels like the perfect
"religious issue" for people to have endless disagreements over. I guess,
over the next couple or so weeks, I'll find out if switching back was a good
idea.</p></div>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="https://blog.davep.org/2017/04/01/another_revamp_of_my_emacs_config.html#another_revamp_of_my_emacs_config">Another revamp of my emacs config</a></h2>
    <p>
      Posted on 2017-04-01 10:02 +0100 in <a href="https://blog.davep.org/category/emacs.html">Emacs</a>

          &#8226; Tagged with
              <a href="https://blog.davep.org/tag/emacs.html">Emacs</a>,              <a href="https://blog.davep.org/tag/lisp.html">Lisp</a>,              <a href="https://blog.davep.org/tag/emacs-lisp.html">Emacs Lisp</a>,              <a href="https://blog.davep.org/tag/coding.html">coding</a>
        &#8226; 4 min read
    </p>
  </header>
  <div>
      <div><p>Just under a year ago I decided to
<a href="/2016/05/26/starting_fresh_with_gnu_emacs.html">totally rewrite my GNU emacs config</a>.
As I wrote at the time, it'd been following me around all sorts of machines
since the early 1990s, starting life on an OS/2 Warp machine and travelling
via MS-DOS, GNU/Linux, Windows and, these days, macOS.</p>
<p>The changes I made last year have served me really well, but there were two
related issues with it that bothered me a little: the fact that I was
maintaining a local library of elisp code in the repository and, worse
still, I was storing the packages I'd installed from elpa and melpa in the
repository as well.</p>
<p>While this did mean it was pretty easy for me to start up a new installation
of emacs on a machine -- all I had to do was clone the repo and run up emacs
-- I wasn't happy with the duplication involved. I didn't like holding code
in my <code>.emacs.d</code> repo that was already held in package archives.</p>
<p>The solution I saw was in two parts:</p>
<ol>
<li>Get some of my code, that might be useful to others, into melpa.</li>
<li>Somehow sort my own package archive for my personal code.</li>
</ol>
<p></p>

<p>Over the past week or so I've worked on this approach. It initially started
with me tackling item 1 above: I tidied up and
submitted
<a href="https://github.com/davep/obfusurl.el"><code>obfusurl.el</code></a>,
<a href="https://github.com/davep/protocols.el"><code>protocols.el</code></a>,
<a href="https://github.com/davep/services.el"><code>services.el</code></a>,
<a href="https://github.com/davep/thinks.el"><code>thinks.el</code></a> and
<a href="https://github.com/davep/uptimes.el"><code>uptimes.el</code></a>. This was a really
helpful process in that it allowed me to brush up on my elisp and emacs
knowledge. It's a good 15+ years since I last wrote any significant elisp
code and things have moved on a little in that time.</p>
<p>Having done that I'd managed to move a handful of my own packages out of my
local library of code, and so out of my <code>.emacs.d</code> repo, but it left me with
the problem of what to do with the rest of it.</p>
<p>That's when I discovered <code>package-x</code> and:</p>
<div class="highlight"><pre><span></span><code><span class="p">,</span><span class="o">----</span><span class="p">[</span><span class="w"> </span><span class="n">C</span><span class="o">-</span><span class="n">h</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="n">package</span><span class="o">-</span><span class="n">upload</span><span class="o">-</span><span class="n">buffer</span><span class="w"> </span><span class="n">RET</span><span class="w"> </span><span class="p">]</span>
<span class="o">|</span><span class="w"> </span><span class="n">package</span><span class="o">-</span><span class="n">upload</span><span class="o">-</span><span class="n">buffer</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">interactive</span><span class="w"> </span><span class="n">compiled</span><span class="w"> </span><span class="n">Lisp</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="ow">in</span>
<span class="o">|</span><span class="w"> </span><span class="err">‘</span><span class="n">package</span><span class="o">-</span><span class="n">x</span><span class="o">.</span><span class="n">el</span><span class="err">’</span><span class="o">.</span>
<span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="n">package</span><span class="o">-</span><span class="n">upload</span><span class="o">-</span><span class="n">buffer</span><span class="p">)</span>
<span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">Upload</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="n">buffer</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="o">-</span><span class="n">file</span><span class="w"> </span><span class="n">Emacs</span><span class="w"> </span><span class="n">Lisp</span><span class="w"> </span><span class="n">package</span><span class="o">.</span>
<span class="o">|</span><span class="w"> </span><span class="n">If</span><span class="w"> </span><span class="err">‘</span><span class="n">package</span><span class="o">-</span><span class="n">archive</span><span class="o">-</span><span class="n">upload</span><span class="o">-</span><span class="n">base</span><span class="err">’</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">specify</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">valid</span><span class="w"> </span><span class="n">upload</span>
<span class="o">|</span><span class="w"> </span><span class="n">destination</span><span class="p">,</span><span class="w"> </span><span class="n">prompt</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">one</span><span class="o">.</span>
<span class="err">`</span><span class="o">----</span>
</code></pre></div>

<p>(plus <code>package-upload-file</code> too, of course). This meant I could, in effect,
start my own personal package archive and look at tackling issue 2 above.</p>
<p>This did give me one small problem though: how and where would I host the
archive? I did consider hosting it on a DigitalOcean droplet, but that felt
a little like overkill for something so simple. And then I
realised: <a href="https://pages.github.com/">GitHub Pages</a>! All I needed to do was
keep the package archive in its own repo (which I would have done anyway)
and then make the whole repo the source for a GitHub Pages site. A quick
test later and... it worked!</p>
<p>So, by this point, I'd farmed some of my code off to melpa, and now had the
rest of it in "delpa" (which I'd called my personal archive). I could now
use the emacs package management system to install third party packages and
also my own.</p>
<p>But I was still left with one issue: I was still holding the installed
packages inside my <code>.emacs.d</code> repo by way of ensuring that all machines were
in sync in terms of what was installed. Now I needed to work out how to
solve that.</p>
<p>Around this time, as luck would have
it, <a href="https://github.com/tarsius">@tarsius</a>
had
<a href="https://github.com/davep/boxquote.el/pull/1#issuecomment-288462491">suggested I look at</a> a
package called <a href="https://github.com/jwiegley/use-package"><code>use-package</code></a>
by <a href="https://github.com/jwiegley">@jwiegley</a>. This was the bit I was missing.</p>
<p>With <code>use-package</code> I would be able to declare which packages I needed, how
they'd be installed and, most important of all, it could be set to handle
the fact that the package wasn't even installed. If a package is requested
and there is no local install <code>use-package</code> is smart enough to get the emacs
package system to install it.</p>
<p>So, given that, all I need to do was <a href="https://github.com/davep/.emacs.d/blob/1fa67c2895f345098057654f6acb3b57a77f1194/startup/davep-packages.el">create a startup file that would
declare the packages I use</a> and
I'd have a setup that should, once I'd cloned <code>.emacs.d</code>, self-install.</p>
<p>Except... yeah, one more issue. <code>use-package</code> isn't part of GNU emacs yet so
I'd need a method of getting it to auto-install so it could then handle
everything else. As it was that was as easy as adding this to the start of
my <a href="https://github.com/davep/.emacs.d/blob/master/init.el"><code>init.el</code></a>.</p>
<div class="highlight"><pre><span></span><code><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span class="c1">;; Make sure the package system is up and running early on.</span>
<span class="p">(</span><span class="nb">require</span><span class="w"> </span><span class="ss">&#39;package</span><span class="p">)</span>
<span class="p">(</span><span class="nv">add-to-list</span><span class="w"> </span><span class="ss">&#39;package-archives</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="s">&quot;melpa&quot;</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="s">&quot;http://melpa.org/packages/&quot;</span><span class="p">))</span>
<span class="p">(</span><span class="nv">add-to-list</span><span class="w"> </span><span class="ss">&#39;package-archives</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="s">&quot;delpa&quot;</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="s">&quot;http://blog.davep.org/delpa/&quot;</span><span class="p">))</span>
<span class="p">(</span><span class="nv">package-initialize</span><span class="p">)</span>

<span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span class="c1">;; Bootstrap `use-package&#39;</span>
<span class="p">(</span><span class="nb">unless</span><span class="w"> </span><span class="p">(</span><span class="nv">package-installed-p</span><span class="w"> </span><span class="ss">&#39;use-package</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nv">package-refresh-contents</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nv">package-install</span><span class="w"> </span><span class="ss">&#39;use-package</span><span class="p">))</span>
</code></pre></div>

<p>With that in place I was able to nuke all my config on a machine, clone a
fresh copy of <code>.emacs.d</code> (having now ceased tracking and storing the
installed packages in that repo), run up emacs, wait a few moments and then
find that everything was installed and ready to use.</p>
<p>Perfect!</p>
<p>My <a href="https://github.com/davep/.emacs.d"><code>.emacs.d</code></a> is now a lot smaller than
it was before and, I think, even easier to maintain. Right now I think I'm
very close to the ideal emacs config that I wanted to create when I did the
complete rewrite a year ago.</p></div>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="https://blog.davep.org/2017/03/13/i_want_to_like_gboard.html#i_want_to_like_gboard">I want to like Gboard</a></h2>
    <p>
      Posted on 2017-03-13 08:29 +0000 in <a href="https://blog.davep.org/category/tech.html">Tech</a>

          &#8226; Tagged with
              <a href="https://blog.davep.org/tag/google.html">Google</a>,              <a href="https://blog.davep.org/tag/android.html">Android</a>
        &#8226; 3 min read
    </p>
  </header>
  <div>
      <div><p>I want to like Gboard. On paper it looks really rather good. It's a keyboard
from Google, it ties in with your account, it syncs things, it has clever
searching for emoji and gifs and the like... what's not to like?</p>
<p>Problem is, I've been a user of SwiftKey since around 2011 (I think it was).
I'm very used to how SwiftKey works and it also contains a lot of handy
things. I like that it has smart completion, that it learns how I type a bit
skewed and that it takes this into account, that I can turn off the fancy
swipe typing and instead make use of handy gestures like swipe-left to
delete a word. I like some of the themes a lot.</p>
<p>Into the mix comes my iPad, which I use on occasion. The standard Apple
keyboard is horrible and, sadly, I find SwiftKey on iOS just as frustrating.
It seems to lack enough key features there (especially the word deletion
gesture, as far as I can tell) that it's also a bit annoying. My dream of a
consistent typing experience across all devices just wasn't happening --
until I found Gboard on iOS.</p>
<p>That felt almost right. And from what I could tell it worked almost exactly
the same on iOS and Android. So it felt like a good time to try and force
myself to use Gboard on my Google Pixel and Nexus 7.</p>
<p>Sadly, though, I'm just not getting on with it. It's okay. It's not bad.
It's just... not good. I'm finding that it lacks enough useful things that
it's a frustrating experience. Little things like: when I enter Google
Search, there's no word completion in the keyboard (SwiftKey has that); the
word deletion gesture (swipe left from the backspace key) seems very
hit-and-miss; the most obvious completion for a word sometimes appears in
the middle slot but, other times, in the left slot. And so on.</p>
<p>Nothing huge. Nothing that's a show-stopper. But a handful of a little
things that make me miss the comfortable home that is SwiftKey.</p>
<p>Don't get me wrong, it does have some very handy and cleaver features too.
The searching for emoji -- including showing them up as word completions --
is rather clever. The gif-search thing is all kinds of fun too (mostly used
to annoy the hell out
of <a href="https://twitter.com/VolcanicArts">my son on twitter</a>).</p>
<p>None of those quite make up for the bits I miss from SwiftKey though.</p>
<p>All that said, I've being making a point of pushing on with Gboard, thinking
that most of my issues might just be because I'm too used to my "old home".
Mostly this was working well, until I noticed something this morning. While
reading the description for Gboard I noticed this handy thing in the "Pro
Tips" section:</p>
<blockquote>
<p>Sync your learned words across devices to improve suggestions (enable in
Gboard Settings→ Dictionary → Sync learned words).</p>
</blockquote>
<p>Useful! I'd assumed that this was the case anyway -- it's Google after all
-- but it's good to know I can ensure it's turned on. So I went to turn it
on. This is what I found:</p>
<p><img alt="Gboard WTF" src="/attachments/2017/03/13/Screenshot_20170313-072359.png"></p>
<p>What the hell Google? Sure, I do have a Gsuite account on my phone -- as in
various apps have access to a Gsuite account (Gmail, Drive, etc...) -- but
it's not the primary account on my phone and it's not the account I'd really
want to be doing the dictionary sync with anyway. If I've got dictionary
sync I want it tied to the keyboard no matter the app I'm in, and no matter
the account I'm using in that app. I want the keyboard to be tied to a
specific account when it comes to sync (just like SwiftKey does it).</p>
<p>This, I think, is a show-stopper for me.</p>
<p>I can overlook the other niggles, I can learn to cope with it not being
quite so perfect in some situations; but the blanket inability to do
something as simple as cloud-sync the predictions and learn from how I type
-- things that are, these days, central to what Google's about -- it's
frankly stupid.</p>
<p>I guess I'm going to have to keep Gboard as a backup keyboard for those
times when I need to find the perfect gif.</p>
<p><img alt="Google WTF" src="http://i.imgur.com/0mw1I8e.gif"></p></div>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="https://blog.davep.org/2017/03/12/google_now_achievements?.html#google_now_achievements?">Google Now Achievements?</a></h2>
    <p>
      Posted on 2017-03-12 12:16 +0000 in <a href="https://blog.davep.org/category/tech.html">Tech</a>

          &#8226; Tagged with
              <a href="https://blog.davep.org/tag/google.html">Google</a>
        &#8226; 1 min read
    </p>
  </header>
  <div>
      <div><p>Over the past couple or so weeks I've been having some issues with Google
Now. It first seemed to start on my Nexus 7, then appeared on my Nexus 6.
More recently, even as of today, I've seen it on
my <a href="/2017/03/08/hello_google_pixel.html">Google Pixel</a>. The problem is that,
in the Google Now launcher (or on the Pixel, in the Pixel launcher), the
Google Now page (that you swipe to the left for) sits empty for ages. All I
see is the little animated waiting circle and nothing else. Once or twice
I've had the Google app die and restart or, more often than not, after quite
some time it finally loads up.</p>
<p>The latter happened a little earlier and I noticed something I'd not seen
before:</p>
<p><img alt="Blank Google Now" src="/attachments/2017/03/12/Screenshot_20170312-115910.jpg"></p>
<p>What's with that "Achievements" menu option? You'll notice that the whole of
the menu is blank -- no profile picture or anything and none of the menu
options seemed to work.</p>
<p>Eventually, after I'd left it for a while, it ended up working.</p>
<p><img alt="Google Now finally working" src="/attachments/2017/03/12/Screenshot_20170312-120052.jpg"></p>
<p>And, once this happened, no "Achievements" option.</p>
<p>Presumably this is some back-end server issue, I'm being served up something
I'm not supposed to be seeing and it's confusing the client app. Okay, I
don't <em>know</em> that's the case, but it has that sort of feel.</p>
<p>So now I need to go looking for what this Achievements thing is all about.</p>
<p>Using Google, obviously.</p></div>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="https://blog.davep.org/2017/03/10/jsng.html#jsng">jsNG</a></h2>
    <p>
      Posted on 2017-03-10 10:14 +0000 in <a href="https://blog.davep.org/category/coding.html">Coding</a>

          &#8226; Tagged with
              <a href="https://blog.davep.org/tag/norton-guide.html">Norton Guide</a>,              <a href="https://blog.davep.org/tag/coding.html">Coding</a>,              <a href="https://blog.davep.org/tag/javascript.html">JavaScript</a>
        &#8226; 3 min read
    </p>
  </header>
  <div>
      <div><p>Like many programmers, I have a couple of "Hello, World" projects that I've
carried with me over the years. One is 5x5 (which has been used to get to
grips with things as diverse as the Palm Pilot and GNU emacs). Another
is <a href="https://en.wikipedia.org/wiki/Norton_Guides">Norton Guides database</a>
<a href="http://www.davep.org/norton-guides/">readers</a>.</p>
<p>I've made Norton Guides tools that have allowed web servers to serve guides
(<code>w3ng</code>), that have allowed you to convert guides to HTML (<code>ng2html</code>), that
have let you read guides on OS/2 and GNU/Linux (<code>eg</code>) and also have let you
read guides in Microsoft Windows (<code>weg</code>). It's a problem I know fairly well
and one where I know the solution well enough so I can concentrate on
learning the new language or environment.</p>
<p>Recently I wanted to get to grips with some
"pure" <a href="http://es6-features.org/#Constants">ES6</a> coding while also getting
to know <a href="https://nodejs.org/en/">node.js</a>. A new version of the Norton Guide
code, written for this environment, seemed like a good thing to do.</p>
<p>And so <a href="https://github.com/davep/jsNG">jsNG</a> was born.</p>
<p>At its core is <a href="https://github.com/davep/jsNG/tree/master/lib">a library of code for opening and reading data from Norton
Guides databases</a>. While I
doubt it's good ES6 code, or even good node.js code, it's been very useful
in giving me a fun problem to solve and it'll carry on being something I'll
tweak and tinker with by way of trying new things out.</p>
<p>On top of this I've built a handful of tools for working with Norton Guides
databases. The most useful one at the moment (the others are more in the
"test the library" than the "make something handy with the library"
category) is <code>ngserve</code>. This is designed as a simple Norton Guides database
HTTP server.</p>
<p><img alt="ngserve in action" src="/attachments/2017/03/10/Screen Shot 2017-03-10 at 10.10.18.png"></p>
<p>When run, you give it a list of guides to serve:</p>
<p><img alt="Starting ngserve" src="/attachments/2017/03/10/Screen Shot 2017-03-10 at 10.26.44.png"></p>
<p>and it does the right thing. It has a small number of command line options
that help configure what it does:</p>
<p><img alt="ngserve command line options" src="/attachments/2017/03/10/Screen Shot 2017-03-10 at 10.29.28.png"></p>
<p>Possibly the most useful are the ones that let you change how it handles
"higher" DOS characters and, if you don't like the default colours and
stuff, the option that lets you point to your own style sheet (note for now
you'll need to host the stylesheet somewhere else -- ngserve won't serve it
for you; I'm aiming to change that in some way in the near future).</p>
<p>jsNG does have a fairly basic design compromise at its heart. In the very
early version I started out using the async functions for opening and
reading the guides. This got very tedious very quickly and I could see that
it was going to make for a very messy library with a very messy interface.
While it might not be in the spirit of node.js programming I decided to go
with the sync version of the file IO functions and code up the core library
based around this.</p>
<p>This approach also means that I took another leap that I never have done
with Norton Guides before: rather than doing the traditional thing of
keeping an open handle into them and reading direct from the file as you
navigate the guide, I simply read it all into a buffer in one go and keep it
in memory. This is a "guides are small, memory is cheap, things will go
faster" approach.</p>
<p>It does mean that when you load up a load of guides into <code>ngserve</code> they're
all sat in memory. The upside of this is that things should be a lot faster
and the code is a lot easier to follow (I think). To put this in some
perspective: I have a directory here that contains 110 Norton Guides files.
They total 36M in size. If that seems like a lot of stuff to hold in
memory... remind me how much is being used by your web browser so you can
look at some hilarious kittens. ;)</p>
<p>Anyway, that's where I'm at with it right now. The code is mostly settled
and mostly tidy. I need to write up some documentation for it (and so I need
to take a look at good JavaScript documentation tools) and perhaps tinker
with <code>ngserve</code> a little more. I'd also like to do a new version of <code>ng2html</code>
with this -- a version that makes it <em>far</em> easier to control the style of
the output. I'm also tempted to do a CLI-based reader in pure ES6; something
similar to <code>EG</code> or <code>WEG</code>.</p>
<p>All in good time.</p></div>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="https://blog.davep.org/2017/03/08/hello_google_pixel.html#hello_google_pixel">Hello Google Pixel</a></h2>
    <p>
      Posted on 2017-03-08 12:22 +0000 in <a href="https://blog.davep.org/category/tech.html">Tech</a>

          &#8226; Tagged with
              <a href="https://blog.davep.org/tag/google.html">Google</a>,              <a href="https://blog.davep.org/tag/android.html">Android</a>,              <a href="https://blog.davep.org/tag/phone.html">Phone</a>
        &#8226; 3 min read
    </p>
  </header>
  <div>
      <div><p>For the past two years I've, mostly, being happily using a Google Nexus 6 as
my phone. In the past six months or so I've started to notice that it hasn't
been quite as good as it was. The main problem, for me, was that the camera
was starting to play out. The issues were the ones that I've seen reported
elsewhere: use of the camera would quickly make the phone laggy, very slow
response times on pressing the shutter, occasional failure to save an image,
etc. This was generally frustrating and, even more so, because <a href="/2016/11/15/seen_by_davep_(the_return).html">I'd got back
into photoblogging</a>.</p>
<p>Meanwhile... I've been lusting over the Google Pixel ever since it was
originally shown off. I was some way off my phone contract renewal and the
price of a new Pixel was something I just couldn't justify. Last week though
an offer cropped up that meant I could renew early <em>and</em> get a Pixel
(including a free Daydream headset thrown in).</p>
<p>Fast forward to Monday just gone and...</p>
<p><img alt="My new Pixel" src="/attachments/2017/03/08/IMG_20170308_120458.jpg"></p>
<p>So far I'm liking it rather a lot. It is odd that it's smaller in my hand
than the Nexus 6 was (the XL wasn't an available option <em>and</em> I was also
starting to think it was time to drop down in size a little again) but I'm
also finding it a little easier to work with; it's also nice that it fits in
trouser pockets as well as jacket pockets.</p>
<p>It feels very fast (although every Android phone and tablet I've ever had
have felt fast to start with) and smooth to use. I especially like the
default feedback vibration -- it's a lot smoother yet also more reassuring
than any I've felt before.</p>
<p>The Google Assistant is proving to be very handy. I'm sort of used to it
anyway thanks to having owned an Android Wear watch for a couple of years
but having it on the phone like this seems like a natural next step.</p>
<p>Another thing I'm getting very used to very quickly, and really liking a
lot, is fingerprint recognition. I didn't think I needed it but now I'm
wondering how I ever managed without it. Combined with the notification
pull-down gesture that the recognition area supports it seems like a perfect
way to open the get going with a phone.</p>
<p>There's a couple of niggles with it, of course. The main one for me is the
lack of wireless charging. That was something I really liked about the Nexus
6: I could be sat at my desk and have the phone sat on top of a charging
pad, staying topped up. No such handy setup with the Pixel. The other thing
is the lack of water resistance. To be fair: it's not something I've ever
really felt I <em>needed</em> with other phones and I'm not in the habit of
sticking them under water; but knowing that it doesn't matter too much if it
gets exposed to rain would be nice.</p>
<p>Other than that... there's not much else to say right now. It works and
works well, the move from the N6 to it was pretty smooth and the Pixel has
fallen perfectly into my normal routine.</p></div>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="https://blog.davep.org/2016/11/15/seen_by_davep_(the_return).html#seen_by_davep_(the_return)">Seen by davep (the return)</a></h2>
    <p>
      Posted on 2016-11-15 15:52 +0000 in <a href="https://blog.davep.org/category/creative.html">Creative</a>

          &#8226; Tagged with
              <a href="https://blog.davep.org/tag/blogging.html">blogging</a>,              <a href="https://blog.davep.org/tag/photography.html">photography</a>
        &#8226; 2 min read
    </p>
  </header>
  <div>
      <div><p>A few years back, not long after I got my first smartphone (a HTC Magic), I
started maintaining a photoblog that was based around photos I took on that
phone. The blog itself was very important to me as it covered a pretty
difficult time in my life -- many of the images on it contained and conveyed
feelings and emotions that seem a world away now, but which I never want to
totally forget.</p>
<p>It served as a visual diary, a note to future me.</p>
<p>And, hopefully, it provided some entertainment for those who viewed it.</p>
<p>Sadly the company who hosted
it
<a href="https://en.wikipedia.org/wiki/Posterous#Shutting_down_Posterous_and_building_PostHaven">closed down</a> and
the whole thing was lost, except for a hasty (and only partially successful)
backup to <a href="https://seenbydavep.wordpress.com/">a Wordpress blog</a>.</p>
<p>After the blog died I sort of lost interest in trying to maintain one and,
to some degree, lost interest in active photography in general. Between the
blog disappearing and another disappointing event relating to photography I
sort of lost confidence in myself and my ability to dare to publish photos
online.</p>
<p>This year, despite how shitty it's been for the world in general, has been a
really good one for me. Lots of positive changes have happened and continue
to happen and I noticed that I was starting to do the phone-based photoblog
thing
again, <a href="https://twitter.com/davepdotorg/media">albeit only via twitter</a>.</p>
<p><img alt="From up the hill" src="/attachments/2016/11/15/FromUpTheHill.jpg"></p>
<p>Finally, this week, I've cracked and decided to make it "official". My old
"Seen by davep" blog is reborn, with new content and the same old purpose.
You can find it here: <a href="http://seenbydavep.blogspot.com/"><strong>seenbydavep.blogspot.com</strong></a></p>
<p>The blog itself is still driven by twitter and the posts will still appear
on twitter. In the background I have an <a href="https://ifttt.com/">IFTTT</a> process
running, watching for any tweet of mine with the #photoblog tag and creating
a post on the blog from it.</p>
<p>As for how often and what the content will be... simple: it'll be when I see
something that I need to capture.</p></div>
  </div>
</article>

  <div class="pagination">
    <a class="btn float-left" href="https://blog.davep.org/author/dave-pearson12.html">
      <i class="fa fa-angle-left"></i> Older Posts
    </a>
    <a class="btn float-right" href="https://blog.davep.org/author/dave-pearson10.html">
      Newer Posts <i class="fa fa-angle-right"></i>
    </a>
  </div>



<footer>
<p>&copy; 2015-2024 Dave Pearson</p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
  <span class="footer-separator">|</span>
  Switch to the <a href="javascript:void(0)" onclick="theme.switch(`dark`)">dark</a> | <a href="javascript:void(0)" onclick="theme.switch(`light`)">light</a> | <a href="javascript:void(0)" onclick="theme.switch(`browser`)">browser</a> theme
  <script id="dark-theme-script"
          src="https://blog.davep.org/theme/dark-theme/dark-theme.min.js"
          data-enable-auto-detect-theme="True"
          data-default-theme="dark"
          type="text/javascript">
  </script>
</p></footer>  </main>

<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " blog.davep.org ",
  "url" : "https://blog.davep.org",
  "image": "/static/davep.jpeg",
  "description": ""
}
</script>
</body>
</html>