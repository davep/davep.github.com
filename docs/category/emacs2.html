
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="" />

  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="https://blog.davep.org/theme/stylesheet/style.min.css">

    <link id="dark-theme-style" rel="stylesheet" type="text/css"
          media="(prefers-color-scheme: dark), (prefers-color-scheme: no-preference)"
    href="https://blog.davep.org/theme/stylesheet/dark-theme.min.css">

    <link id="pygments-dark-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: dark), (prefers-color-scheme: no-preference)"
          href="https://blog.davep.org/theme/pygments/monokai.min.css">
    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: light)"
          href="https://blog.davep.org/theme/pygments/github.min.css">



  <link rel="stylesheet" type="text/css" href="https://blog.davep.org/theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="https://blog.davep.org/theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="https://blog.davep.org/theme/font-awesome/css/solid.css">

  <link rel="stylesheet" type="text/css" href="https://blog.davep.org/static/davep.css">

  <link rel="shortcut icon" href="/static/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/static/favicon.ico" type="image/x-icon">


  <link href="https://blog.davep.org/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="blog.davep.org Atom">

  <link href="https://blog.davep.org/feed.xml" type="application/rss+xml" rel="alternate" title="blog.davep.org RSS">







 

    <meta name="author" content="Dave Pearson" />
    <meta name="description" content="" />
  <meta property="og:site_name" content="blog.davep.org"/>
  <meta property="og:type" content="blog"/>
  <meta property="og:title" content="blog.davep.org"/>
  <meta property="og:description" content=""/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:url" content="https://blog.davep.org"/>
  <meta property="og:image" content="/static/davep.jpeg">

  <title>blog.davep.org &ndash; Category Emacs</title>


</head>
<body >

<aside>
  <div>
    <a href="https://blog.davep.org/">
      <img src="/static/davep.jpeg" alt="" title="">
    </a>

    <h1>
      <a href="https://blog.davep.org/"></a>
    </h1>



    <nav>
      <ul class="list">


            <li>
              <a target="_blank"
                 href="https://blog.davep.org/pages/about.html#about">
                About
              </a>
            </li>

          <li>
            <a target="_blank" href="http://davep.at/" >davep.at</a>
          </li>
          <li>
            <a target="_blank" href="https://pinboard.in/u:davep" >Pinboard</a>
          </li>
          <li>
            <a target="_blank" href="https://seenbydavep.blogspot.com/" >Photoblog</a>
          </li>
          <li>
            <a target="_blank" href="https://pypi.org/user/davepearson/" >Python Packages</a>
          </li>
      </ul>
    </nav>

    <ul class="social">
      <li>
        <a class="sc-github"
           href="https://github.com/davep"
           target="_blank">
          <i class="fa-brands fa-github"></i>
        </a>
      </li>
      <li>
        <a class="sc-mastodon"
rel="me"           href="https://fosstodon.org/@davep"
           target="_blank">
          <i class="fa-brands fa-mastodon"></i>
        </a>
      </li>
      <li>
        <a class="sc-flickr"
           href="https://www.flickr.com/photos/davepearson/"
           target="_blank">
          <i class="fa-brands fa-flickr"></i>
        </a>
      </li>
      <li>
        <a class="sc-lastfm"
           href="https://www.last.fm/user/davepdotorg"
           target="_blank">
          <i class="fa-brands fa-lastfm"></i>
        </a>
      </li>
      <li>
        <a class="sc-npm"
           href="https://www.npmjs.com/~davep.org"
           target="_blank">
          <i class="fa-brands fa-npm"></i>
        </a>
      </li>
      <li>
        <a class="sc-youtube"
           href="https://www.youtube.com/user/daveporg"
           target="_blank">
          <i class="fa-brands fa-youtube"></i>
        </a>
      </li>
      <li>
        <a class="sc-steam"
           href="https://steamcommunity.com/id/davepdotorg"
           target="_blank">
          <i class="fa-brands fa-steam"></i>
        </a>
      </li>
    </ul>
  </div>

</aside>
  <main>

<nav>
  <a href="https://blog.davep.org/">Home</a>

  <a href="/archives.html">Archives</a>
  <a href="/categories.html">Categories</a>
  <a href="/tags.html">Tags</a>

  <a href="https://blog.davep.org/feeds/all.atom.xml">Atom</a>

  <a href="https://blog.davep.org/feed.xml">RSS</a>
</nav>



<article>
  <header>
    <h2><a href="https://blog.davep.org/2019/10/19/pypath-el.html#pypath-el">pypath.el -- A little Emacs hack to help with Django</a></h2>
    <p>
      Posted on 2019-10-19 10:35 +0100 in <a href="https://blog.davep.org/category/emacs.html">Emacs</a>

          &#8226; Tagged with
              <a href="https://blog.davep.org/tag/emacs.html">Emacs</a>,              <a href="https://blog.davep.org/tag/python.html">Python</a>,              <a href="https://blog.davep.org/tag/django.html">Django</a>,              <a href="https://blog.davep.org/tag/lisp.html">Lisp</a>
    </p>
  </header>
  <div>
      <div><p>One of the things I really like about coding with Emacs is how I can easily
identify a repeated task and turn it into a command in my environment,
saving me a load of work down the line.</p>
<p><a href="https://github.com/davep/pypath.el"><code>pypath.el</code></a> is one such example.</p>
<p>In my day job I write a lot of Django code. As part of that, I write a good
number of unit tests too. Sometimes I'll write the tests as I'm writing the
code they test, other times I'm writing them afterwards; it all really
depends on where my head's at and how the code is flowing.</p>
<p>When I'm writing those tests, I often want to test them as I go. Given that
starting up a test session can take a while, and given that running all the
tests in the system can take a while, it's really handy if I can run that
single test I'm working on.</p>
<p>This is easy enough with Django. In my work environment it's normally
something like:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>pipenv<span class="w"> </span>run<span class="w"> </span>./manage.py<span class="w"> </span><span class="nb">test</span><span class="w"> </span>-v<span class="w"> </span><span class="m">2</span><span class="w"> </span>app.test.some.sub.module.TestClass.test_method
</code></pre></div>

<p>Only... typing out the:</p>
<div class="highlight"><pre><span></span><code><span class="n">app</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">some</span><span class="o">.</span><span class="n">sub</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">TestClass</span><span class="o">.</span><span class="n">test_method</span>
</code></pre></div>

<p>part is a bit of a pain. Sure, once you've typed it the once you can use
your shell of choice (mine being <a href="https://fishshell.com/">fish</a> and on
occasion
<a href="https://www.gnu.org/software/emacs/manual/html_mono/eshell.html">eshell</a>)
to recall it from history, but typing it out the first time is the annoying
part.</p>
<p>So this was the point where I took 1/2 hour or so to code up
<a href="https://github.com/davep/pypath.el"><code>pypath.el</code></a> to solve the problem for
me. It gives me two commands:</p>
<ul>
<li><code>pypath</code>: which simply places the dotted path of the <a href="http://doc.endlessparentheses.com/Fun/python-info-current-defun.html">current
  "defun"</a>,
  within the context of being part of a Django system, into the clipboard
  buffer.</li>
<li><code>pypath-django-test</code>: which works similar to the above but places the
  whole Django testing command into the clipboard.</li>
</ul>
<p>With the above, I can work on a test, hit the latter command above, flip to
my command line, paste and I'm running the test.</p>
<p>Of course, I'm sure there's plenty of other handy ways to do this. Doubtless
there's work environments where the test can be run right there, in the edit
buffer, without flipping away, and which takes into account the fact that
there's a pipenv-managed virtual environment involved, etc. If there is,
that's great, but I don't think it'd work with how I work.</p>
<p>And that's one of the things I really love about Emacs, and why it's still
my work environment after almost 25 years of on and off use: with very
little work on my part I can create a couple of commands that work exactly
how I need them to. While it's great to create <a href="https://melpa.org/">generally-useful code for
Emacs that lots of people benefit from</a>, sometimes the
real value is that <a href="https://blog.davep.org/delpa/">you can code up your own particular quirk and just get
on with stuff</a>.</p>
<p>To conclude: this post isn't to show off <code>pypath.el</code>; really this post is to
sing the praises of Emacs and why it still works so well for me after all
these years.</p></div>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="https://blog.davep.org/2017/07/13/more_revamping_of_my_emacs_config.html#more_revamping_of_my_emacs_config">More revamping of my Emacs config</a></h2>
    <p>
      Posted on 2017-07-13 15:25 +0100 in <a href="https://blog.davep.org/category/emacs.html">Emacs</a>

          &#8226; Tagged with
              <a href="https://blog.davep.org/tag/emacs.html">Emacs</a>,              <a href="https://blog.davep.org/tag/lisp.html">Lisp</a>,              <a href="https://blog.davep.org/tag/programming.html">programming</a>,              <a href="https://blog.davep.org/tag/emacs-lisp.html">Emacs Lisp</a>
    </p>
  </header>
  <div>
      <div><p>I've been pretty quiet on here since I last wrote about how I'd done a
further revamp of my Emacs config, so I thought that subject would be a good
reason to write another blog post.</p>
<p>It'll be a mostly short one, and one to muse over something that's been
bugging me for a while now: my decision to lean heavily on <code>customize</code> to
set all sorts of settings.</p>
<p>Initially,
<a href="/2016/05/26/starting_fresh_with_gnu_emacs.html">when I nuked my original config over a year ago</a>,
it seemed to make a lot of sense. Let all the tweaks and set values "hide"
in a file of their own and try and keep the hand-edited config files as
small and as clean as possible. Recently though I've got to thinking that
this obscures too much, hides too much detail, and removes the ability to
actually document what I'm doing and why. It also does make it tricky to
adapt some settings to different platforms or even environments on a single
platform.</p>
<p>Another problem I've run into is
this:
<a href="/2017/04/01/another_revamp_of_my_emacs_config.html">when I made the second round of changes</a> and
decided to lean heavily
on <a href="https://github.com/jwiegley/use-package"><code>use-package</code></a>, I soon ran into
the minor issue of some packages not making sense, or even being needed, on
some platforms (stuff that's useful on my macOS machines isn't always useful
on my Windows machines, that sort of thing). While <code>use-package</code> can handle
this easily thanks to the <code>:if</code> keyword, I'm still left with the fact that
<code>package-selected-packages</code> still gets populated.</p>
<p>Having <code>package-selected-packages</code> contain a list of installed packages
likely makes sense if you're using just the Emacs package system and you're
not doing the installing with <code>use-package</code> and <code>:ensure</code>. But with
<code>use-package</code> and <code>:ensure</code> I feel like I've got far more control over
things and can adapt what gets installed when depending on which Emacs I'm
running where.</p>
<p>But, because I'm syncing my <code>~/.emacs.d/.custom.el</code> to all my machines too, any
<code>use-package</code> that has a <code>:if</code> to not bother using a package has little
effect because the package still ends up being listed/loaded/seen as part of
the installation.</p>
<p>Ideally, I think, I'd like to be able to have <code>package-selected-packages</code>
held in its own file, or I'd only ever use <code>~/.emacs.d/.custom.el</code> for local
stuff (and so stop syncing it).</p>
<p>Starting today I'm going about a process of moving as much as I can out of
<code>~/.emacs.d/.custom.el</code> and into hand-edited files. In some respects I guess
I am going back to how I used to manage Emacs configuration, but this time
it's not a massive monolithic file-of-Lisp, it's neatly broken down into
sensible sections and it's also biased towards a "grab and config this
package" approach.</p>
<p>Meanwhile, I've not seen any good discussions online about <code>customize</code> vs
"hand-edit", which strikes me as a little odd as it feels like the perfect
"religious issue" for people to have endless disagreements over. I guess,
over the next couple or so weeks, I'll find out if switching back was a good
idea.</p></div>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="https://blog.davep.org/2017/04/01/another_revamp_of_my_emacs_config.html#another_revamp_of_my_emacs_config">Another revamp of my emacs config</a></h2>
    <p>
      Posted on 2017-04-01 10:02 +0100 in <a href="https://blog.davep.org/category/emacs.html">Emacs</a>

          &#8226; Tagged with
              <a href="https://blog.davep.org/tag/emacs.html">Emacs</a>,              <a href="https://blog.davep.org/tag/lisp.html">Lisp</a>,              <a href="https://blog.davep.org/tag/emacs-lisp.html">Emacs Lisp</a>,              <a href="https://blog.davep.org/tag/programming.html">Programming</a>
    </p>
  </header>
  <div>
      <div><p>Just under a year ago I decided to
<a href="/2016/05/26/starting_fresh_with_gnu_emacs.html">totally rewrite my GNU emacs config</a>.
As I wrote at the time, it'd been following me around all sorts of machines
since the early 1990s, starting life on an OS/2 Warp machine and travelling
via MS-DOS, GNU/Linux, Windows and, these days, macOS.</p>
<p>The changes I made last year have served me really well, but there were two
related issues with it that bothered me a little: the fact that I was
maintaining a local library of elisp code in the repository and, worse
still, I was storing the packages I'd installed from elpa and melpa in the
repository as well.</p>
<p>While this did mean it was pretty easy for me to start up a new installation
of emacs on a machine -- all I had to do was clone the repo and run up emacs
-- I wasn't happy with the duplication involved. I didn't like holding code
in my <code>.emacs.d</code> repo that was already held in package archives.</p>
<p>The solution I saw was in two parts:</p>
<ol>
<li>Get some of my code, that might be useful to others, into melpa.</li>
<li>Somehow sort my own package archive for my personal code.</li>
</ol>
<p></p>

<p>Over the past week or so I've worked on this approach. It initially started
with me tackling item 1 above: I tidied up and
submitted
<a href="https://github.com/davep/obfusurl.el"><code>obfusurl.el</code></a>,
<a href="https://github.com/davep/protocols.el"><code>protocols.el</code></a>,
<a href="https://github.com/davep/services.el"><code>services.el</code></a>,
<a href="https://github.com/davep/thinks.el"><code>thinks.el</code></a> and
<a href="https://github.com/davep/uptimes.el"><code>uptimes.el</code></a>. This was a really
helpful process in that it allowed me to brush up on my elisp and emacs
knowledge. It's a good 15+ years since I last wrote any significant elisp
code and things have moved on a little in that time.</p>
<p>Having done that I'd managed to move a handful of my own packages out of my
local library of code, and so out of my <code>.emacs.d</code> repo, but it left me with
the problem of what to do with the rest of it.</p>
<p>That's when I discovered <code>package-x</code> and:</p>
<div class="highlight"><pre><span></span><code><span class="p">,</span><span class="o">----</span><span class="p">[</span><span class="w"> </span><span class="n">C</span><span class="o">-</span><span class="n">h</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="n">package</span><span class="o">-</span><span class="n">upload</span><span class="o">-</span><span class="n">buffer</span><span class="w"> </span><span class="n">RET</span><span class="w"> </span><span class="p">]</span>
<span class="o">|</span><span class="w"> </span><span class="n">package</span><span class="o">-</span><span class="n">upload</span><span class="o">-</span><span class="n">buffer</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">interactive</span><span class="w"> </span><span class="n">compiled</span><span class="w"> </span><span class="n">Lisp</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="ow">in</span>
<span class="o">|</span><span class="w"> </span><span class="err">‘</span><span class="n">package</span><span class="o">-</span><span class="n">x</span><span class="o">.</span><span class="n">el</span><span class="err">’</span><span class="o">.</span>
<span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="n">package</span><span class="o">-</span><span class="n">upload</span><span class="o">-</span><span class="n">buffer</span><span class="p">)</span>
<span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">Upload</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="n">buffer</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="o">-</span><span class="n">file</span><span class="w"> </span><span class="n">Emacs</span><span class="w"> </span><span class="n">Lisp</span><span class="w"> </span><span class="n">package</span><span class="o">.</span>
<span class="o">|</span><span class="w"> </span><span class="n">If</span><span class="w"> </span><span class="err">‘</span><span class="n">package</span><span class="o">-</span><span class="n">archive</span><span class="o">-</span><span class="n">upload</span><span class="o">-</span><span class="n">base</span><span class="err">’</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">specify</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">valid</span><span class="w"> </span><span class="n">upload</span>
<span class="o">|</span><span class="w"> </span><span class="n">destination</span><span class="p">,</span><span class="w"> </span><span class="n">prompt</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">one</span><span class="o">.</span>
<span class="err">`</span><span class="o">----</span>
</code></pre></div>

<p>(plus <code>package-upload-file</code> too, of course). This meant I could, in effect,
start my own personal package archive and look at tackling issue 2 above.</p>
<p>This did give me one small problem though: how and where would I host the
archive? I did consider hosting it on a DigitalOcean droplet, but that felt
a little like overkill for something so simple. And then I
realised: <a href="https://pages.github.com/">GitHub Pages</a>! All I needed to do was
keep the package archive in its own repo (which I would have done anyway)
and then make the whole repo the source for a GitHub Pages site. A quick
test later and... it worked!</p>
<p>So, by this point, I'd farmed some of my code off to melpa, and now had the
rest of it in "delpa" (which I'd called my personal archive). I could now
use the emacs package management system to install third party packages and
also my own.</p>
<p>But I was still left with one issue: I was still holding the installed
packages inside my <code>.emacs.d</code> repo by way of ensuring that all machines were
in sync in terms of what was installed. Now I needed to work out how to
solve that.</p>
<p>Around this time, as luck would have
it, <a href="https://github.com/tarsius">@tarsius</a>
had
<a href="https://github.com/davep/boxquote.el/pull/1#issuecomment-288462491">suggested I look at</a> a
package called <a href="https://github.com/jwiegley/use-package"><code>use-package</code></a>
by <a href="https://github.com/jwiegley">@jwiegley</a>. This was the bit I was missing.</p>
<p>With <code>use-package</code> I would be able to declare which packages I needed, how
they'd be installed and, most important of all, it could be set to handle
the fact that the package wasn't even installed. If a package is requested
and there is no local install <code>use-package</code> is smart enough to get the emacs
package system to install it.</p>
<p>So, given that, all I need to do was <a href="https://github.com/davep/.emacs.d/blob/1fa67c2895f345098057654f6acb3b57a77f1194/startup/davep-packages.el">create a startup file that would
declare the packages I use</a> and
I'd have a setup that should, once I'd cloned <code>.emacs.d</code>, self-install.</p>
<p>Except... yeah, one more issue. <code>use-package</code> isn't part of GNU emacs yet so
I'd need a method of getting it to auto-install so it could then handle
everything else. As it was that was as easy as adding this to the start of
my <a href="https://github.com/davep/.emacs.d/blob/master/init.el"><code>init.el</code></a>.</p>
<div class="highlight"><pre><span></span><code><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span class="c1">;; Make sure the package system is up and running early on.</span>
<span class="p">(</span><span class="nb">require</span><span class="w"> </span><span class="ss">&#39;package</span><span class="p">)</span>
<span class="p">(</span><span class="nv">add-to-list</span><span class="w"> </span><span class="ss">&#39;package-archives</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="s">&quot;melpa&quot;</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="s">&quot;http://melpa.org/packages/&quot;</span><span class="p">))</span>
<span class="p">(</span><span class="nv">add-to-list</span><span class="w"> </span><span class="ss">&#39;package-archives</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="s">&quot;delpa&quot;</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="s">&quot;http://blog.davep.org/delpa/&quot;</span><span class="p">))</span>
<span class="p">(</span><span class="nv">package-initialize</span><span class="p">)</span>

<span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span class="c1">;; Bootstrap `use-package&#39;</span>
<span class="p">(</span><span class="nb">unless</span><span class="w"> </span><span class="p">(</span><span class="nv">package-installed-p</span><span class="w"> </span><span class="ss">&#39;use-package</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nv">package-refresh-contents</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nv">package-install</span><span class="w"> </span><span class="ss">&#39;use-package</span><span class="p">))</span>
</code></pre></div>

<p>With that in place I was able to nuke all my config on a machine, clone a
fresh copy of <code>.emacs.d</code> (having now ceased tracking and storing the
installed packages in that repo), run up emacs, wait a few moments and then
find that everything was installed and ready to use.</p>
<p>Perfect!</p>
<p>My <a href="https://github.com/davep/.emacs.d"><code>.emacs.d</code></a> is now a lot smaller than
it was before and, I think, even easier to maintain. Right now I think I'm
very close to the ideal emacs config that I wanted to create when I did the
complete rewrite a year ago.</p></div>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="https://blog.davep.org/2016/05/26/starting_fresh_with_gnu_emacs.html#starting_fresh_with_gnu_emacs">Starting fresh with GNU emacs</a></h2>
    <p>
      Posted on 2016-05-26 12:28 +0100 in <a href="https://blog.davep.org/category/emacs.html">Emacs</a>

          &#8226; Tagged with
              <a href="https://blog.davep.org/tag/emacs.html">Emacs</a>
    </p>
  </header>
  <div>
      <div><p>As I've mentioned elsewhere on this blog, over the past few years, my
use of GNU emacs has lapsed somewhat. There was a time when it was my
only editor (except for the odd dips into vim to do some quick
editing) and, back when I used to use GNU Linux as a desktop machine a
lot, I'd have an emacs session up and running pretty much non-stop (it
was one of the reasons I wrote
<a href="https://github.com/davep/uptimes.el">uptimes.el</a>).</p>
<p>In more recent times I've been working more on Windows and often
inside Visual Studio. Even for my own "for fun" programming, I've
mostly being doing things that didn't involve emacs much. In fact,
most of my recent "for fun" coding has been done using
<a href="https://www.sublimetext.com/">Sublime Text</a> because it was powerful,
cross-platform and also had great support for
<a href="http://wiki.secondlife.com/wiki/LSL_Portal">the language I code in a lot when it comes to personal amusement projects</a>.</p>
<p>During that time I've wanted to get back into emacs. Quite a bit seems
to have changed since I was last a very avid user and this also meant
wanting and needing to catch up.</p>
<p>The first thing I needed to do was finally get around to killing off
my old <code>~/.emacs</code> file. This has followed me around since I first got
into emacs on OS/2 back in the mid 1990s. The file started out with a
few <code>setq</code> expressions to tweak some settings and just kept growing
and growing. It'd got to a point where there was old stuff in there
that I had no use for and sometimes even no idea what it was
for. Heck, to give some idea of how old the file was: there were items
in there that handled running emacs on MS-DOS!</p>
<p>So, a couple of weeks back, I dumped it. Dumped the whole lot. The
plan then was to recreate it with as little hands-on coding as
possible. I decided that, as much as I could, I'd tweak using
<code>customize</code> and only hand-code (in <code>~/.emacs.d/init.el</code> this time
around) things when there was no obvious other way to do it.</p>
<p>So far this is working out really well. Gone has the ugly and
monolithic <code>.emacs</code>, replaced with something far more modular, much
more tidy and far easier to maintain. Whereas my old config was almost
1,000 lines long, the new <code>init.el</code> is currently just 50 lines:</p>
<div class="highlight"><pre><span></span><code><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span class="c1">;; Make use of the Common Lisp compatibility module.</span>
<span class="p">(</span><span class="nb">require</span><span class="w"> </span><span class="ss">&#39;cl</span><span class="p">)</span>

<span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span class="c1">;; Local config/lib directory support.</span>

<span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">davep:user-path</span><span class="w"> </span><span class="p">(</span><span class="nv">path</span><span class="p">)</span>
<span class="w">  </span><span class="s">&quot;Given </span><span class="ss">`file&#39;</span><span class="s">, return a path for it in the local config.&quot;</span>
<span class="w">  </span><span class="p">(</span><span class="nf">concat</span><span class="w"> </span><span class="nv">user-emacs-directory</span><span class="w"> </span><span class="nv">path</span><span class="p">))</span>

<span class="p">(</span><span class="k">defvar</span><span class="w"> </span><span class="nv">davep:local</span><span class="w"> </span><span class="p">(</span><span class="nv">davep:user-path</span><span class="w"> </span><span class="s">&quot;davep/&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="s">&quot;My local config and code directory.&quot;</span><span class="p">)</span>

<span class="p">(</span><span class="k">defvar</span><span class="w"> </span><span class="nv">davep:startup</span><span class="w"> </span><span class="p">(</span><span class="nv">davep:user-path</span><span class="w"> </span><span class="s">&quot;davep/startup&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="s">&quot;My local startup code.&quot;</span><span class="p">)</span>

<span class="p">(</span><span class="k">defvar</span><span class="w"> </span><span class="nv">davep:lib</span><span class="w"> </span><span class="p">(</span><span class="nv">davep:user-path</span><span class="w"> </span><span class="s">&quot;davep/lib&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="s">&quot;My local library code.&quot;</span><span class="p">)</span>

<span class="p">(</span><span class="k">defvar</span><span class="w"> </span><span class="nv">davep:lib-3rd-party</span><span class="w"> </span><span class="p">(</span><span class="nv">davep:user-path</span><span class="w"> </span><span class="s">&quot;davep/lib-3rd-party&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="s">&quot;My local third party code.&quot;</span><span class="p">)</span>

<span class="p">(</span><span class="nb">push</span><span class="w"> </span><span class="nv">davep:local</span><span class="w">         </span><span class="nv">load-path</span><span class="p">)</span>
<span class="p">(</span><span class="nb">push</span><span class="w"> </span><span class="nv">davep:startup</span><span class="w">       </span><span class="nv">load-path</span><span class="p">)</span>
<span class="p">(</span><span class="nb">push</span><span class="w"> </span><span class="nv">davep:lib</span><span class="w">           </span><span class="nv">load-path</span><span class="p">)</span>
<span class="p">(</span><span class="nb">push</span><span class="w"> </span><span class="nv">davep:lib-3rd-party</span><span class="w"> </span><span class="nv">load-path</span><span class="p">)</span>

<span class="p">(</span><span class="nb">defun</span><span class="w"> </span><span class="nv">have-own-package-p</span><span class="w"> </span><span class="p">(</span><span class="nv">package</span><span class="p">)</span>
<span class="w">  </span><span class="s">&quot;Does a package of my own exist in this environment?&quot;</span>
<span class="w">  </span><span class="p">(</span><span class="nv">locate-library</span><span class="w"> </span><span class="nv">package</span><span class="w"> </span><span class="no">nil</span><span class="w"> </span><span class="p">(</span><span class="nf">list</span><span class="w"> </span><span class="nv">davep:lib</span><span class="p">)))</span>

<span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span class="c1">;; Ensure custom values go in their own file.</span>
<span class="p">(</span><span class="k">setq</span><span class="w"> </span><span class="nv">custom-file</span><span class="w"> </span><span class="p">(</span><span class="nv">davep:user-path</span><span class="w"> </span><span class="s">&quot;custom.el&quot;</span><span class="p">))</span>
<span class="p">(</span><span class="nf">load</span><span class="w"> </span><span class="nv">custom-file</span><span class="p">)</span>

<span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span class="c1">;; Load various startup things.</span>
<span class="p">(</span><span class="nf">load</span><span class="w"> </span><span class="s">&quot;env-tests&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="nb">require</span><span class="w"> </span><span class="ss">&#39;davep-keys</span><span class="p">)</span>
<span class="p">(</span><span class="nb">require</span><span class="w"> </span><span class="ss">&#39;davep-languages</span><span class="p">)</span>
<span class="p">(</span><span class="nb">require</span><span class="w"> </span><span class="ss">&#39;davep-style</span><span class="p">)</span>
<span class="p">(</span><span class="nb">require</span><span class="w"> </span><span class="ss">&#39;uptimes</span><span class="p">)</span>
<span class="p">(</span><span class="nb">require</span><span class="w"> </span><span class="ss">&#39;csrclr</span><span class="p">)</span>

<span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span class="c1">;; Local autoloading.</span>
<span class="p">(</span><span class="nb">require</span><span class="w"> </span><span class="ss">&#39;autoloading</span><span class="p">)</span>
<span class="p">(</span><span class="nv">load-davep-autoloads</span><span class="p">)</span>
</code></pre></div>

<p>All the other stuff, things to tweak language modes so they indent
"just so", my own special keyboard bindings, that sort of thing,
they're all farmed off into their own files:</p>
<div class="highlight"><pre><span></span><code>davep@Bellerophon:~/.emacs.d/davep/startup$<span class="w"> </span>v
total<span class="w"> </span><span class="m">40</span>
-rw-r--r--<span class="w">  </span><span class="m">1</span><span class="w"> </span>davep<span class="w">  </span>staff<span class="w">  </span><span class="m">4211</span><span class="w"> </span><span class="m">24</span><span class="w"> </span>May<span class="w"> </span><span class="m">14</span>:38<span class="w"> </span>davep-keys.el
-rw-r--r--<span class="w">  </span><span class="m">1</span><span class="w"> </span>davep<span class="w">  </span>staff<span class="w">  </span><span class="m">4078</span><span class="w"> </span><span class="m">16</span><span class="w"> </span>May<span class="w"> </span><span class="m">13</span>:51<span class="w"> </span>davep-languages.el
-rw-r--r--<span class="w">  </span><span class="m">1</span><span class="w"> </span>davep<span class="w">  </span>staff<span class="w">   </span><span class="m">537</span><span class="w"> </span><span class="m">25</span><span class="w"> </span>May<span class="w"> </span><span class="m">14</span>:13<span class="w"> </span>davep-style.el
-rw-r--r--<span class="w">  </span><span class="m">1</span><span class="w"> </span>davep<span class="w">  </span>staff<span class="w">  </span><span class="m">1339</span><span class="w"> </span><span class="m">16</span><span class="w"> </span>May<span class="w"> </span><span class="m">09</span>:39<span class="w"> </span>env-tests.el
</code></pre></div>

<p>Another thing I'm trying to do is dump all the old third party code I
had locally and, instead, use emacs' own package manager
now. Currently this is also working well for me given that I'm using
both <a href="https://elpa.gnu.org/">ELPA</a> and <a href="https://melpa.org/#/">MELPA</a>.</p>
<p>I haven't managed to dump everything yet, but it's a useful exercise
to slowly work through the various files I was carting around and
deciding if I need them or not (like, I'm fairly sure I won't be
needing a <code>cobol-mode</code> any time soon -- that can go).</p>
<p>On top of all of this, on top of starting with a "clean slate" emacs,
I've also started keeping track of what I do on GitHub. I've got a
private repo for my <code>~/.emacs.d/</code> that I can now easily sync between
my various machines.</p>
<p>One final thing that I'm starting to try and do is actually make full
use of emacs again. One example is that I'm writing this blog post in
it. Until now I've been using SublimeText with
<a href="https://packagecontrol.io/packages/Jekyll">a Jekyll package to compose and manage things</a>
but, this time around I'm giving <a href="https://melpa.org/#/hyde">hyde</a> and
<a href="https://melpa.org/#/markdown-mode">markdown-mode</a> a go. So far
they're working out pretty well too (albeit hyde was a bit odd to set
up and isn't 100% making sense to me yet).</p></div>
  </div>
</article>

  <div class="pagination">
    <a class="btn float-right" href="https://blog.davep.org/category/emacs.html">
      Newer Posts <i class="fa fa-angle-right"></i>
    </a>
  </div>



<footer>
<p>&copy; 2015-2023 Dave Pearson</p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
  <span class="footer-separator">|</span>
  Switch to the <a href="javascript:void(0)" onclick="theme.switch(`dark`)">dark</a> | <a href="javascript:void(0)" onclick="theme.switch(`light`)">light</a> | <a href="javascript:void(0)" onclick="theme.switch(`browser`)">browser</a> theme
  <script id="dark-theme-script"
          src="https://blog.davep.org/theme/dark-theme/dark-theme.min.js"
          data-enable-auto-detect-theme="True"
          data-default-theme="dark"
          type="text/javascript">
  </script>
</p></footer>  </main>

<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " blog.davep.org ",
  "url" : "https://blog.davep.org",
  "image": "/static/davep.jpeg",
  "description": ""
}
</script>
</body>
</html>