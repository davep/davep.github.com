<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="blogmore v1.2.0">
    <link rel="canonical" href="https://blog.davep.org/2019/12/14/nuke-buffers-el.html">
    <title>nuke-buffers.el -- Tidy up open buffers in Emacs - davep</title>
    
    <link rel="icon" href="/icons/favicon.ico">
    
    
    <!-- Shortcut icon for backward compatibility -->
    <link rel="shortcut icon" href="/favicon.ico">
    <!-- Favicon alternatives -->
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-touch-icon-120.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-touch-icon-152.png">
    <link rel="apple-touch-icon" sizes="167x167" href="/icons/apple-touch-icon-167.png">
    <!-- Android/Chrome -->
    <link rel="manifest" href="/icons/site.webmanifest">
    <!-- Windows/Edge -->
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-config" content="/icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    
    
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/webfonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
    <link rel="stylesheet" href="/static/fontawesome.css">
    
    <link rel="stylesheet" href="/static/styles.min.css">
    
    
    <link rel="alternate" type="application/rss+xml" title="davep - RSS Feed" href="https://blog.davep.org/feed.xml">
    <link rel="alternate" type="application/atom+xml" title="davep - Atom Feed" href="https://blog.davep.org/feeds/all.atom.xml">
    
    
    
    
    
    
    
    









<meta name="author" content="Dave Pearson">



<meta name="description" content="Both at work and at home I use Emacs by keeping a copy running all the time, and use emacsclient to open files inside it (including on remote machines thanks to a bit of ssh and heavy use of tramp -- I might write this up at some point). This works really well, but does mean I tend to build up a lot of buffers over time.">


<meta name="keywords" content="Emacs, Lisp, Emacs Lisp">



<meta property="og:title" content="nuke-buffers.el -- Tidy up open buffers in Emacs">
<meta property="og:type" content="article">
<meta property="og:url" content="https://blog.davep.org/2019/12/14/nuke-buffers-el.html">

<meta property="og:description" content="Both at work and at home I use Emacs by keeping a copy running all the time, and use emacsclient to open files inside it (including on remote machines thanks to a bit of ssh and heavy use of tramp -- I might write this up at some point). This works really well, but does mean I tend to build up a lot of buffers over time.">

<meta property="og:site_name" content="davep">

<meta property="og:image" content="https://blog.davep.org/icons/android-chrome-512x512.png">





<meta property="article:published_time" content="2019-12-14T13:17:00+00:00">


<meta property="article:modified_time" content="2019-12-14T13:17:00+00:00">


<meta property="article:author" content="Dave Pearson">


<meta property="article:section" content="Emacs">



<meta property="article:tag" content="Emacs">

<meta property="article:tag" content="Lisp">

<meta property="article:tag" content="Emacs Lisp">





<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="nuke-buffers.el -- Tidy up open buffers in Emacs">

<meta name="twitter:description" content="Both at work and at home I use Emacs by keeping a copy running all the time, and use emacsclient to open files inside it (including on remote machines thanks to a bit of ssh and heavy use of tramp -- I might write this up at some point). This works really well, but does mean I tend to build up a lot of buffers over time.">


<meta name="twitter:image" content="https://blog.davep.org/icons/android-chrome-512x512.png">




    <script src="/static/theme.min.js"></script>
    
    
    
    <link rel="prev" href="/2019/12/08/git2gantt.html">
    <link rel="next" href="/2020/01/11/where-i-live-and-work.html">

</head>
<body>
    <div class="site-container">
        <aside class="sidebar">
            <div class="sidebar-content">
                <div class="sidebar-header">
                    
                    <div class="sidebar-logo">
                        <a href="/">
                            <img src="/logo.jpeg" alt="davep">
                        </a>
                    </div>
                    

                    <div class="sidebar-title">
                        <h1><a href="/">davep</a></h1>
                        
                        <p class="sidebar-subtitle">Code and stuff</p>
                        
                    </div>
                </div>

                
                <div class="sidebar-pages">
                    <ul class="sidebar-links">
                        
                        <li><a href="/about.html">About</a></li>
                        
                        <li><a href="/dotfiles.html">Dot Files</a></li>
                        
                    </ul>
                </div>
                

                
                <section class="sidebar-section">
                    <h2>Links</h2>
                    <ul class="sidebar-links">
                        
                        <li><a href="https://davep.at/" target="_blank" rel="noopener noreferrer">davep@</a></li>
                        
                        <li><a href="https://raindrop.io/davep/public-46742255/sort=-created&amp;perpage=30&amp;page=0" target="_blank" rel="noopener noreferrer">Bookmarks</a></li>
                        
                        <li><a href="https://seenbydavep.blogspot.com/" target="_blank" rel="noopener noreferrer">Photoblog</a></li>
                        
                        <li><a href="https://elisp.dev/" target="_blank" rel="noopener noreferrer">Emacs Packages</a></li>
                        
                        <li><a href="https://pypi.org/user/davepearson/" target="_blank" rel="noopener noreferrer">Python Packages</a></li>
                        
                    </ul>
                </section>
                

                
                <section class="sidebar-section">
                    <h2>Social</h2>
                    <div class="sidebar-socials">
                        
                        <a href="https://www.flickr.com/photos/davepearson/" title="flickr" aria-label="flickr" target="_blank" rel="noopener noreferrer">
                            <i class="fa-brands fa-flickr"></i>
                        </a>
                        
                        <a href="https://github.com/davep" title="github" aria-label="github" target="_blank" rel="noopener noreferrer">
                            <i class="fa-brands fa-github"></i>
                        </a>
                        
                        <a href="https://www.last.fm/user/davepdotorg" title="lastfm" aria-label="lastfm" target="_blank" rel="noopener noreferrer">
                            <i class="fa-brands fa-lastfm"></i>
                        </a>
                        
                        <a href="https://fosstodon.org/@davep" title="mastodon" aria-label="mastodon" target="_blank" rel="noopener noreferrer">
                            <i class="fa-brands fa-mastodon"></i>
                        </a>
                        
                        <a href="https://www.npmjs.com/~davep.org" title="npm" aria-label="npm" target="_blank" rel="noopener noreferrer">
                            <i class="fa-brands fa-npm"></i>
                        </a>
                        
                        <a href="https://steamcommunity.com/id/davepdotorg" title="steam" aria-label="steam" target="_blank" rel="noopener noreferrer">
                            <i class="fa-brands fa-steam"></i>
                        </a>
                        
                        <a href="https://www.youtube.com/user/daveporg" title="youtube" aria-label="youtube" target="_blank" rel="noopener noreferrer">
                            <i class="fa-brands fa-youtube"></i>
                        </a>
                        
                    </div>
                </section>
                
            </div>
        </aside>

        <div class="main-wrapper">
            <header>
                <nav>
                    <ul>
                        <li><a href="/categories.html">Categories</a></li>
                        <li><a href="/tags.html">Tags</a></li>
                        <li><a href="/archive.html">Archive</a></li>
                        
                        <li><a href="/search.html">Search</a></li>
                        
                        
                        <li><a href="/feed.xml" title="Subscribe via RSS feed">RSS</a></li>
                        <li><a href="/feeds/all.atom.xml" title="Subscribe via Atom feed">Atom</a></li>
                        
                        <li>
                            <button class="theme-toggle" type="button" aria-label="Toggle theme">
                                <span class="icon light-icon">‚òÄÔ∏è</span>
                                <span class="icon dark-icon">üåô</span>
                                <span class="theme-label">Theme</span>
                            </button>
                        </li>
                    </ul>
                </nav>
            </header>

            <main>
                
<article class="post">
    
    <nav class="post-navigation post-navigation-top">
        
        <a href="/2019/12/08/git2gantt.html" class="post-nav-link post-nav-prev" title="git2gantt -- Simple tool to visualise coding runs">
            <span class="post-nav-label">‚Üê Previous Post</span>
        </a>
        
        
        <a href="/2020/01/11/where-i-live-and-work.html" class="post-nav-link post-nav-next" title="Where I live and work">
            <span class="post-nav-label">Next Post ‚Üí</span>
        </a>
        
    </nav>
    
    
    <header class="post-header">
        <h1>nuke-buffers.el -- Tidy up open buffers in Emacs</h1>
        
        <time datetime="2019-12-14T13:17:00+00:00"><a href="/2019/">2019</a>-<a href="/2019/12/">12</a>-<a href="/2019/12/14/">14</a> 13:17:00 UTC</time>
        
        <div class="reading-time">2 min read</div>
        
        <div class="category">
            <a href="/category/emacs.html" class="category-link">Emacs</a>
        </div>
        
    </header>
    
    <div class="post-content">
        <p>Both at work and at home I use Emacs by <a href="https://github.com/davep/longmacs.el" rel="noopener noreferrer" target="_blank">keeping a copy running all the
time</a>, and use <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Emacs-Server.html#Emacs-Server" rel="noopener noreferrer" target="_blank"><code>emacsclient</code> to open
files inside
it</a>
(including on remote machines thanks to a bit of
<a href="https://en.wikipedia.org/wiki/Secure_Shell" rel="noopener noreferrer" target="_blank"><code>ssh</code></a> and heavy use of
<a href="https://www.gnu.org/software/tramp/" rel="noopener noreferrer" target="_blank"><code>tramp</code></a> -- I might write this up at
some point). This works really well, but does mean I tend to build up a lot
of buffers over time.</p>
<p>Having lots of buffers open isn't generally an issue, and if I'm working on
lots of different files in a project during the course of a hacking session
it's actually a good thing. But, quite often, I want to tidy up the buffer
list, clearing it back to near-zero buffers open. Many years ago, when I had
a "proper" tower system running 24/7, with Emacs open all the time, I'd use
<a href="https://www.emacswiki.org/emacs/MidnightMode" rel="noopener noreferrer" target="_blank"><code>clean-buffer-list</code> as part of
<code>midnight</code></a>. Along the way
that fell out of favour with me, likely because I drifted into using
machines that had Emacs open all the time but where the machine wasn't awake
all the time.</p>
<p>Eventually I decided to have some fun rolling my own solution, and
<a href="https://github.com/davep/nuke-buffers.el" rel="noopener noreferrer" target="_blank"><code>nuke-buffers</code></a> was born.</p>
<p>Rather than try and do things in an automated way, this was designed to be
<a href="https://github.com/davep/.emacs.d/blob/ffc863ca0fb669d2f6639bda62e81764c35767ce/init.d/packages/init-packages-delpa.el#L98-L107" rel="noopener noreferrer" target="_blank">bound to a key (or
two)</a>
and then be run when I wanted, being as harsh as possible about cleaning up
the buffer list. Since first writing it it's worked well for me.</p>
<p>These days I tend to let the buffer list build up as I work on a new
feature, or chase down a bug, etc. Then, once I've made the final commit for
that period of focus, I'll hit the <code>nuke-buffer</code> key combo as the final act
of confirming that I've done the job. So not only does this help tidy my
Emacs session a bit, it also feels like a physical form of punctuation --
back in less sensible days, when I had some terrible habits, it would have
been when I'd reach for the celebratory cigarette; buffer-tidying feels far
more wholesome. ;)</p>
<p>The way the code works is, of course, mostly directed at how I work -- it's
highly likely it wouldn't make sense for many other people. The main aim is
to kill as many buffers as possible, but without disturbing anything else.
The list of buffers it gathers for nuking avoids buffers that are <a href="https://github.com/davep/nuke-buffers.el/blob/d018499b78968f074565c076068f657a1631aa07/nuke-buffers.el#L60-L62" rel="noopener noreferrer" target="_blank">visiting
files but have unsaved
content</a>,
avoids <a href="https://github.com/davep/nuke-buffers.el/blob/d018499b78968f074565c076068f657a1631aa07/nuke-buffers.el#L54" rel="noopener noreferrer" target="_blank">the
minibuffer</a>
(obviously), avoids <a href="https://github.com/davep/nuke-buffers.el/blob/d018499b78968f074565c076068f657a1631aa07/nuke-buffers.el#L56" rel="noopener noreferrer" target="_blank">any "special"
buffer</a>
(one that starts with a space then an asterisk), avoids <a href="https://github.com/davep/nuke-buffers.el/blob/d018499b78968f074565c076068f657a1631aa07/nuke-buffers.el#L73" rel="noopener noreferrer" target="_blank">the current
buffer</a>
and also avoids <a href="https://github.com/davep/nuke-buffers.el/blob/d018499b78968f074565c076068f657a1631aa07/nuke-buffers.el#L58" rel="noopener noreferrer" target="_blank">any buffer in a list of names to
avoid</a>.</p>
<p>I've being using this on a daily basis for around 2.5 years now and it's
done the job without ever losing me any work.</p>
    </div>
    
    
    <div class="tags">
        
        <a href="/tag/emacs.html" class="tag">Emacs</a>
        
        <a href="/tag/lisp.html" class="tag">Lisp</a>
        
        <a href="/tag/emacs-lisp.html" class="tag">Emacs Lisp</a>
        
    </div>
    
    
    
    <nav class="post-navigation post-navigation-bottom">
        
        <a href="/2019/12/08/git2gantt.html" class="post-nav-link post-nav-prev" title="git2gantt -- Simple tool to visualise coding runs">
            <span class="post-nav-label">‚Üê Previous Post</span>
        </a>
        
        
        <a href="/2020/01/11/where-i-live-and-work.html" class="post-nav-link post-nav-next" title="Where I live and work">
            <span class="post-nav-label">Next Post ‚Üí</span>
        </a>
        
    </nav>
    
</article>

            </main>

            <footer>
                <p>Generated with <a href="https://github.com/davep/blogmore" target="_blank" rel="noopener noreferrer">Blogmore</a></p>
            </footer>
        </div>
    </div>
</body>
</html>