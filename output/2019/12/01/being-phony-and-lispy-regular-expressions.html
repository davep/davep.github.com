<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>"Being phony, and Lispy regular expressions"</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <link href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="blog.davep.org Atom Feed" />
        <meta name="description" content="While it does seem that they're a little out of fashion these days, in some circles anyway, I'm still an avid fan of make and make files. Even in..." />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">blog.davep.org</a></h1>
                <nav><ul>
                    <li class="active"><a href="/category/misc.html">misc</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2019/12/01/being-phony-and-lispy-regular-expressions.html" rel="bookmark"
           title="Permalink to "Being phony, and Lispy regular expressions"">"Being phony, and Lispy regular expressions"</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2019-12-01T16:42:00+00:00">
                Published: Sun 01 December 2019
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/dave-pearson.html">Dave Pearson</a>
        </address>
<p>In <a href="/category/misc.html">misc</a>.</p>
<p>tags: <a href="/tag/emacs.html">[ &#34;emacs&#34;</a> <a href="/tag/lisp.html">&#34;lisp&#34; ]</a> </p>
</footer><!-- /.post-info -->      <p>While it does seem that they're a little out of fashion these days, in some
circles anyway, I'm still an avid fan of <code>make</code> and make files. Even in
environments where I don't need a <code>Makefile</code> to actually build anything,
I'll use one (or more) to help create handy shortcuts for getting stuff
done.</p>
<p>Looking at the main <code>Makefile</code> for one of my major work projects, there's 45
targets that help fire off various jobs (all of them <a href="https://marmelab.com/blog/2016/02/29/auto-documented-makefile.html">self-documenting using
a variation on an approach I read a while
back</a>).</p>
<p>In most cases the targets aren't real targets. That's to say, they don't
build the thing they're called. They are <a href="https://www.gnu.org/software/make/manual/html_node/Phony-Targets.html">phony
targets</a>.
So, as makes sense, I make a point of marking them all as such. I follow the
convention that has the <code>.PHONY</code> marker appear on the line before the
target; this feels cleaner to me and easier to follow and maintain.</p>
<p>But.... I'm lazy. And I use Emacs. Typing out <code>.PHONY foo</code> all the time
feels like far too much work. So, some time ago, I quickly threw together
<a href="https://github.com/davep/make-phony.el"><code>make-phony.el</code></a>.</p>
<p>With this I could be <em>really</em> lazy. I could type out the <code>Makefile</code> target
and then, with my cursor on it, press a key combination and have the
<code>.PHONY</code> marker put in place.</p>
<p>Does it save much time? Yeah, probably not really. But it was a fun little
exercise and an excuse to write a little bit of Emacs Lisp.</p>
<p>There's one thing I made a point of doing in the heart of this too: using
<code>rx</code>. For anyone who doesn't know of it, think of it as a very Lispy way of
writing regular expressions. I won't even try and explain it all here
<a href="http://francismurillo.github.io/2017-03-30-Exploring-Emacs-rx-Macro/">because others have done an excellent job
already</a>.
What I will do is say this: if you're in the habit of writing some Emacs
Lisp, or even tinkering with your configuration, and you find yourself
writing a regular expression, consider looking at <code>rx</code> -- it's well worth
the time to get to know it.</p>
<p>Slowly, as time goes on, I'm weeding out "vanilla" regular expressions from
my config and code and moving over to using <code>rx</code>. I feel, quite rightly I
think, that <a href="https://github.com/davep/.emacs.d/blob/b3185a1dbaa0a16f540465844b84c5e1c6a77180/init.d/packages/init-packages-melpa.el#L117-L126">something like
this</a>:</p>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="nb">rx</span>
<span class="w"> </span><span class="p">(</span><span class="k">or</span>
<span class="w">  </span><span class="c1">;; Ignore hidden files.</span>
<span class="w">  </span><span class="p">(</span><span class="nv">group</span><span class="w"> </span><span class="nv">bol</span><span class="w"> </span><span class="s">&quot;.&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="c1">;; I never want to edit the desktop.</span>
<span class="w">  </span><span class="p">(</span><span class="nv">group</span><span class="w"> </span><span class="s">&quot;Desktop/&quot;</span><span class="w"> </span><span class="nv">eol</span><span class="p">)</span>
<span class="w">  </span><span class="c1">;; Ignore compiled files.</span>
<span class="w">  </span><span class="p">(</span><span class="nv">group</span><span class="w"> </span><span class="s">&quot;.&quot;</span><span class="w"> </span><span class="p">(</span><span class="k">or</span><span class="w"> </span><span class="s">&quot;pyc&quot;</span><span class="w"> </span><span class="s">&quot;elc&quot;</span><span class="p">)</span><span class="w"> </span><span class="nv">eol</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nv">group</span><span class="w"> </span><span class="s">&quot;.egg-info/&quot;</span><span class="w"> </span><span class="nv">eol</span><span class="p">)))</span>
</code></pre></div>

<p>is much easier to write, read and maintain, than this:</p>
<div class="highlight"><pre><span></span><code>&quot;\\(^\\.\\)\\|\\(Desktop/$\\)\\|\\(\\.\\(?:\\(?:\\(?:el\\|py\\)c\\)\\)$\\)\\|\\(\\.egg-info/$\\)&quot;
</code></pre></div>

<p>I mean, even <em>if</em> the regular expression above can be written in a more
efficient way (and I imagine it can), as someone working in a Lisp
environment, I'd much sooner write and work with the <code>rx</code> version.</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://github.com/davep">GitHub</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a href="https://fosstodon.org/@davep">Mastodon</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

<script type="text/javascript">
    var disqus_shortname = 'blogdaveporg';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'https://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>
</html>