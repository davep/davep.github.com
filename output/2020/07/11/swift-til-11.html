<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>"Swift TIL 11"</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Dave Pearson">

    <!-- Le styles -->
    <link rel="stylesheet" href="/theme/css/bootstrap.dark.css" type="text/css" />
    <style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
      .tag-1 {
        font-size: 13pt;
      }
      .tag-2 {
        font-size: 10pt;
      }
      .tag-2 {
        font-size: 8pt;
      }
      .tag-4 {
        font-size: 6pt;
     }
    </style>
    <link href="/theme/css/bootstrap-responsive.dark.css" rel="stylesheet">
        <link href="/theme/css/font-awesome.css" rel="stylesheet">

    <link href="/theme/css/pygments.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/theme/images/favicon.ico">
    <link rel="apple-touch-icon" href="/theme/images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/theme/images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/theme/images/apple-touch-icon-114x114.png">

    <link href="/" type="application/atom+xml" rel="alternate" title="blog.davep.org ATOM Feed" />

  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/index.html">blog.davep.org </a>
          <div class="nav-collapse">
            <ul class="nav">
                          <li class="divider-vertical"></li>
                  <li class="active">
                    <a href="/category/misc.html">
						<i class="icon-folder-open icon-large"></i>misc
					</a>
                  </li>

                          <ul class="nav pull-right">
                                <li><a href="/archives.html"><i class="icon-th-list"></i>Archives</a></li>
                          </ul>

            </ul>
            <!--<p class="navbar-text pull-right">Logged in as <a href="#">username</a></p>-->
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row">
        <div class="span9" id="content">
<section id="content">
        <article>
                <header>
                        <h1>
                                <a href=""
                                        rel="bookmark"
                                        title="Permalink to "Swift TIL 11"">
                                        "Swift TIL 11"
                                </a>
                        </h1>
                </header>
                <div class="entry-content">
                <div class="well">
<footer class="post-info">
<span class="label">Date</span>
<abbr class="published" title="2020-07-11T21:34:00+01:00">
        <i class="icon-calendar"></i>Sat 11 July 2020
</abbr>
<span class="label">By</span>
<a href="/author/dave-pearson.html"><i class="icon-user"></i>Dave Pearson</a>
<span class="label">Category</span>
<a href="/category/misc.html"><i class="icon-folder-open"></i>misc</a>.


<span class="label">Tags</span>
	<a href="/tag/swift.html"><i class="icon-tag"></i>[ "swift"</a>
	<a href="/tag/apple.html"><i class="icon-tag"></i>"apple"</a>
	<a href="/tag/til.html"><i class="icon-tag"></i>"TIL" ]</a>
</footer><!-- /.post-info -->                </div>
                <p>This is one of those things, especially this little play to help appreciate
the feature, that I'm filing under "kinda cool, but I am <em>never</em> doing this
in production".</p>
<p>So Swift has operator overriding, and then some. Moreover, operators are, in
effect, functions, just with some extra syntax support. None of this is new
to me, I've worked in and with other languages that have this ability,
expect... I don't ever recall working in a language that, at the time I did,
supported creating brand new operators (okay, fine, Lisp is a bit of an
outlier here and there's all sorts of fun conversations to be had there --
but still, let's stick with more "conventional" syntax here). Support always
seemed to be about extending the ability of an existing operator.</p>
<p>Swift though... yeah, you get to pick from a huge character space when it
comes to creating operators.</p>
<p>Which got me thinking... How cool would it be to have a prefix operator that
turns a floating point number into a currency-friendly number (you know, the
sort of number type that can be used for currency-friendly calculations).</p>
<p>Swift has the
<a href="https://developer.apple.com/documentation/foundation/decimal"><code>decimal</code></a>
type which, at first glance anyway, looks to be a sensible candidate; even
if it isn't (and, really, how to actually sensibly handle currency is a
whole series of blog posts in their own right, that I have no wish to write
myself because such things are a previous working life for me, and other
people have doubtless done a very comprehensive job elsewhere over the
years) it will serve as a good stand-in for the little bit of horror I'm
going to write next.</p>
<p>So... Let's say we want to use <code>Â£</code> as a prefix operator to say "see this
number? make it a <code>decimal</code>", we could do something as simple as this:</p>
<div class="highlight"><pre><span></span><code><span class="kd">import</span> <span class="nc">Foundation</span>

<span class="kr">prefix</span> <span class="kd">operator</span> <span class="err">Â£</span>
<span class="kr">prefix</span> <span class="kd">func</span> <span class="err">Â£</span><span class="p">(</span> <span class="n">n</span> <span class="p">:</span> <span class="n">Decimal</span> <span class="p">)</span> <span class="p">-&gt;</span> <span class="n">Decimal</span> <span class="p">{</span> <span class="n">n</span> <span class="p">}</span>

<span class="bp">print</span><span class="p">(</span> <span class="err">Â£</span><span class="mf">1.20</span> <span class="o">+</span> <span class="err">Â£</span><span class="mf">0.75</span> <span class="o">+</span> <span class="err">Â£</span><span class="mf">0.01</span> <span class="p">)</span>
</code></pre></div>

<p>Horrifically and delightfully, it works:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>swift<span class="w"> </span>run
<span class="o">[</span><span class="m">3</span>/3<span class="o">]</span><span class="w"> </span>Linking<span class="w"> </span>opover
<span class="m">1</span>.96
</code></pre></div>

<p>I know, I know, I feel bad for even trying. But it's also kinda cool that
the language has this.</p>
<p>It gets better though...</p>
<p>While reading up on what characters can and can't be used as operators, one
thing that stood out was the fact that, more or less, any character that
isn't a valid identifier can be used as an operator. So... hang on, we can
use "emoji" as identifiers?</p>
<p>Like this?</p>
<div class="highlight"><pre><span></span><code><span class="kd">import</span> <span class="nc">Foundation</span>

<span class="kr">prefix</span> <span class="kd">operator</span> <span class="err">Â£</span>
<span class="kr">prefix</span> <span class="kd">func</span> <span class="err">Â£</span><span class="p">(</span> <span class="n">n</span> <span class="p">:</span> <span class="n">Decimal</span> <span class="p">)</span> <span class="p">-&gt;</span> <span class="n">Decimal</span> <span class="p">{</span> <span class="n">n</span> <span class="p">}</span>

<span class="kd">let</span> <span class="err">ðŸ’µ</span> <span class="p">=</span> <span class="err">Â£</span><span class="mf">1.20</span> <span class="o">+</span> <span class="err">Â£</span><span class="mf">0.75</span> <span class="o">+</span> <span class="err">Â£</span><span class="mf">0.01</span>

<span class="bp">print</span><span class="p">(</span> <span class="err">ðŸ’µ</span> <span class="p">)</span>
</code></pre></div>

<p>Why yes. Yes we can. ðŸ˜ˆ</p>
                </div><!-- /.entry-content -->
                <div class="comments">
                <h2>Comments !</h2>
                        <div id="disqus_thread"></div>
                        <script type="text/javascript">
                           var disqus_identifier = "2020/07/11/swift-til-11.html";
                           (function() {
                                var dsq = document.createElement('script');
                                dsq.type = 'text/javascript'; dsq.async = true;
                                dsq.src = 'https://blogdaveporg.disqus.com/embed.js';
                                (document.getElementsByTagName('head')[0] ||
                                 document.getElementsByTagName('body')[0]).appendChild(dsq);
                          })();
                        </script>
                </div>
        </article>
</section>
        </div><!--/span-->

                <div class="span3 well sidebar-nav" id="sidebar">
<ul class="nav nav-list">
<li class="nav-header"><h4><i class="icon-external-link"></i>blogroll</h4></li>
    <li><a href="https://github.com/davep"><i class="icon-external-link"></i>GitHub</a></li>
<li class="nav-header"><h4><i class="icon-home icon-large"></i> social</h4></li>
<li><a href="/" rel="alternate"><i class="icon-bookmark icon-large"></i>atom feed</a></li>
    <li><a href="https://fosstodon.org/@davep"><i class="icon-Mastodon-sign icon-large"></i>Mastodon</a></li>

<li class="nav-header"><h4><i class="icon-folder-close icon-large"></i>Categories</h4></li>
<li>
<a href="/category/misc.html">
    <i class="icon-folder-open icon-large"></i>misc
</a>
</li>

<li class="nav-header"><h4><i class="icon-tags icon-large"></i>Tags</h4></li>


</ul>        </div><!--/.well -->

      </div><!--/row-->

      <hr>

      <footer>
        <address id="about">
                Proudly powered by <a href="http://pelican.notmyidea.org/">Pelican <i class="icon-external-link"></i></a>,
                                which takes great advantage of <a href="http://python.org">Python <i class="icon-external-link"></i></a>.
        </address><!-- /#about -->

        <p>The theme is based on <a href="http://twitter.github.com/bootstrap/">Bootstrap from Twitter <i class="icon-external-link"></i></a>,
                   and <a href="http://fortawesome.github.com/Font-Awesome/">Font-Awesome <i class="icon-external-link"></i></a>, thanks!</p>
      </footer>

    </div><!--/.fluid-container-->


<script type="text/javascript">
    var disqus_shortname = 'blogdaveporg';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>

    <!-- Le javascript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="/theme/js/jquery-1.7.2.min.js"></script>
    <script src="/theme/js/bootstrap.min.js"></script>
  </body>
</html>